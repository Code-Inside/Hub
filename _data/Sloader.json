{"Data":{"Blog":{"FeedItems":[{"Title":"WinUI 3 Community Toolkit and the Template Studio","PublishedOn":"2024-02-24T23:59:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<p>In my last post <a href=\"https://blog.codeinside.eu/2024/02/12/first-steps-with-winui3/\">‚ÄúFirst steps with WinUI 3‚Äù</a> I already mentioned the <a href=\"https://apps.microsoft.com/detail/9p3jfpwwdzrc\">‚ÄúWinUI 3 Gallery‚Äù-App</a>, but I missed mentioning two great resources.</p>\n\n<p>If you take a deeper look at the ‚ÄúHome‚Äù page, you will spot the <a href=\"https://apps.microsoft.com/detail/9nblggh4tlcq\">Community Toolkit Gallery (another app)</a> and the <a href=\"https://marketplace.visualstudio.com/items?itemName=TemplateStudio.TemplateStudioForWinUICs\">‚ÄúTemplate Studio for WinUI‚Äù</a>.</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2024-02-24/winui3gallery.png\" alt=\"x\" title=\"WinUI 3 Gallery\" /></p>\n\n<h1 id=\"what-is-the-community-toolkit\">What is the Community Toolkit?</h1>\n\n<p>The Community Toolkit is a community-driven collection of components and other helpers.</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2024-02-24/community-toolkit.png\" alt=\"x\" title=\"WinUI 3 Gallery\" /></p>\n\n<p>The ‚Äúhome‚Äù of the Community Toolkit can be found on <a href=\"https://github.com/CommunityToolkit/Windows\">GitHub</a></p>\n\n<p>As of today, the Community Toolkit seems ‚Äúalive‚Äù with recent commits in February 2024.</p>\n\n<p>Interesting fact: The controls from the toolkit seems to work with the <a href=\"https://platform.uno/\">Uno Platform</a> as well.</p>\n\n<h1 id=\"what-is-the-template-studio\">What is the Template Studio?</h1>\n\n<p>Template Studio is an addin for Visual Studio and can be installed <a href=\"https://marketplace.visualstudio.com/items?itemName=TemplateStudio.TemplateStudioForWinUICs\">from the Marketplace</a>.</p>\n\n<p>This adds the ‚ÄòTemplate Studio for WinUI‚Äô template to Visual Studio:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2024-02-24/template-studio.png\" alt=\"x\" title=\"Template Studio\" /></p>\n\n<p>After the usual ‚Äúpick a name and location‚Äù you will be greeted with this Wizard:</p>\n\n<p>The first step is to select a ‚ÄúProject type‚Äù:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2024-02-24/template-studio-1.png\" alt=\"x\" title=\"Template Studio - Project Type\" /></p>\n\n<p>In the next step you choose a ‚ÄúDesign pattern‚Äù - which has only one item‚Ä¶ well.</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2024-02-24/template-studio-2.png\" alt=\"x\" title=\"Template Studio - Design pattern\" /></p>\n\n<p>In ‚ÄúPages‚Äù you can create your ‚Äúviews/pages‚Äù based on a given layout:</p>\n\n<p>Some pages can only be added once (e.g. the ‚ÄúSettings‚Äù), but most pages can be added multiple times.</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2024-02-24/template-studio-3.png\" alt=\"x\" title=\"Template Studio - Pages\" /></p>\n\n<p>In ‚ÄúFeatures‚Äù you can add some WinUI 3 related features:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2024-02-24/template-studio-4.png\" alt=\"x\" title=\"Template Studio - Features\" /></p>\n\n<p>In the last setting you can decide if you want to add an MSTest project as well:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2024-02-24/template-studio-5.png\" alt=\"x\" title=\"Template Studio - Testing\" /></p>\n\n<p>The result is the following Visual Studio solution, which includes two projects and a number of <code class=\"language-plaintext highlighter-rouge\">TODO</code> items:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2024-02-24/template-studio-vsproject.png\" alt=\"x\" title=\"Template Studio - Solution\" /></p>\n\n<p>If you run the code a pretty simple app with your configured pages will be found:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2024-02-24/template-studio-result.png\" alt=\"x\" title=\"Template Studio - Result\" /></p>\n\n<p><strong>Warning:</strong> Such code generators might be a good starting point, but (as always with such generators) the code might be ‚Äútoo stupid‚Äù or ‚Äútoo complicated‚Äù - depending on your needs.</p>\n\n<h1 id=\"any-other-useful-resource\">Any other useful resource?</h1>\n\n<p>I‚Äôm a newbie with WinUI 3. The Community Toolkit looks promising and even the Template Studio looks good - at least from a few minutes playtime. If anyone has other useful resource: Please let me know (e.g. in the comments or via email).</p>\n\n<p>Hope this helps!</p>\n\n","Href":"https://blog.codeinside.eu/2024/02/24/winui3-with-community-toolkit-and-template-studio/","RawContent":null,"Thumbnail":null},{"Title":"First steps with WinUI 3","PublishedOn":"2024-02-12T23:55:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<p>Developing desktop apps <strong>for</strong> Windows is quite complex in 2024. There are some ‚Äúold school‚Äù frameworks like WPF or WinForms (or even older stuff) and there is this confusing UWP (but I think it‚Äôs dead). \nThe ‚Äúmodern stack‚Äù seems to be <code class=\"language-plaintext highlighter-rouge\">WinUI</code> - so let‚Äôs take a look.</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2024-02-12/winui.png\" alt=\"x\" title=\"WinUI\" /></p>\n\n<p><em>See <a href=\"https://learn.microsoft.com/en-us/windows/apps/develop/\">here</a></em></p>\n\n<h1 id=\"what-is-winui\">What is WinUI?</h1>\n\n<p>WinUI is the ‚Äúmodern‚Äù version of WPF without the (dumb?) constraints from UWP. You can of course use your typical ‚ÄúWindows‚Äù programming languages (like C# or C++).</p>\n\n<p>If you heard of UWP. The ‚ÄúUniversal Windows Platform‚Äù was a good idea but failed, because - at least from my limited testing - the platform was very strict and you couldn‚Äôt do the same stuff that you can do with WPF/WinForms.</p>\n\n<p>WinUI 1 and 2 were targeted at UWP (if I remember correctly) and with WinUI 3 Microsoft decided to lift those UWP constraints and with it we get a modern desktop stack based on the ‚Äúknown‚Äù XAML.</p>\n\n<p>In summary:</p>\n\n<p>WinUI 3 apps can be used for apps that run on Windows 11 and Windows 10 and can be distributed via the Microsoft Store and you can do the same crazy stuff that you love about WPF/WinForms.</p>\n\n<h1 id=\"does-anybody-outside-of-microsoft-use-winui\">Does anybody outside of Microsoft use WinUI?</h1>\n\n<p>WinUI is used in Windows 11, e.g. the settings or the new explorer - which is nice, but it would be good, if we found a non-Microsoft app that uses this tech, right?</p>\n\n<p>Thankfully last week Apple decided to release <a href=\"https://apps.microsoft.com/detail/9PFHDD62MXS1\">Apple Music</a> (and <a href=\"https://twitter.com/OrderByAsync/status/1755598050641526902\">other apps</a>) as a native Windows app and it seems (<a href=\"https://twitter.com/mixen/status/1757085072115773473\">confirmed</a>) like it was written with WinUI:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2024-02-12/applemusic.png\" alt=\"x\" title=\"Apple Music\" /></p>\n\n<p>If Apple uses this tech, it seems ‚Äúsafe enough‚Äù for some exploration.</p>\n\n<h1 id=\"how-to-get-started\">How to get started?</h1>\n\n<p>You will need <a href=\"https://visualstudio.microsoft.com/vs/\">Visual Studio 2022</a>. Be aware, that even if you check all those desktop related workloads in the installer the WinUI 3 templates <strong>are still missing</strong>.</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2024-02-12/vsinstall.png\" alt=\"x\" title=\"Visual Studio Workloads\" /></p>\n\n<p>For the WinUI 3 templates you will need to install the <strong><a href=\"https://learn.microsoft.com/en-us/windows/apps/windows-app-sdk/\">Windows App SDK</a></strong>.</p>\n\n<h1 id=\"visual-studio-templates\">Visual Studio Templates</h1>\n\n<p>After the Windows App SDK is installed we finally have the templates in Visual Studio:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2024-02-12/vstemplates.png\" alt=\"x\" title=\"Visual Studio Templates\" /></p>\n\n<p>The default <code class=\"language-plaintext highlighter-rouge\">Blank App, Packaged (WinUI 3 in Desktop)</code> is‚Ä¶ well‚Ä¶ quite blank:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2024-02-12/solution.png\" alt=\"x\" title=\"Visual Studio Solution\" /></p>\n\n<p>If you start the application, you will see this:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2024-02-12/startapp.png\" alt=\"x\" title=\"Blank Application\" /></p>\n\n<h1 id=\"packaged-vs-unpacked\">Packaged vs. Unpacked</h1>\n\n<p>If you check the toolbar, you will notice the <code class=\"language-plaintext highlighter-rouge\">App 6 (Package)</code> debug button. <code class=\"language-plaintext highlighter-rouge\">Packaged Apps</code> can access some Windows APIs (e.g. custom context menu extensions) that <code class=\"language-plaintext highlighter-rouge\">Unpackaged Apps</code> can‚Äôt. <code class=\"language-plaintext highlighter-rouge\">Unpackaged Apps</code> on the other hand act like WPF apps - e.g. they have a ‚Äúnormal‚Äù <code class=\"language-plaintext highlighter-rouge\">.exe</code> and can be distributed like any <code class=\"language-plaintext highlighter-rouge\">.exe</code>-file.</p>\n\n<p><a href=\"https://learn.microsoft.com/en-us/windows/apps/get-started/intro-pack-dep-proc#packaged-or-unpackaged\">This documentation page</a> should cover this topic.</p>\n\n<p>Let‚Äôs say we want to have a ‚Äúproper‚Äù <code class=\"language-plaintext highlighter-rouge\">myApp.exe</code> app, then the <code class=\"language-plaintext highlighter-rouge\">Unpackaged App</code> is the way to go. If you choose the <code class=\"language-plaintext highlighter-rouge\">App 6 (Unpackaged)</code> debug option you might see this weird error:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>XamlCheckProcessRequirements();\n\nException Unhandled:\nSystem.DllNotFoundException: 'Unable to load DLL 'Microsoft.ui.xaml.dll' or one of its dependencies: The specified module could not be found. (0x8007007E)'\n</code></pre></div></div>\n\n<p>To fix this, you will need to add this to the <code class=\"language-plaintext highlighter-rouge\">.csproj</code>:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>\t&lt;PropertyGroup&gt;\n\t\t...\n\t\t&lt;WindowsPackageType&gt;None&lt;/WindowsPackageType&gt;\n        ...\n\t&lt;/PropertyGroup&gt;\n</code></pre></div></div>\n\n<p>After that the debug button should start the application and you should be able to start the <code class=\"language-plaintext highlighter-rouge\">.exe</code>.</p>\n\n<h1 id=\"samples\">Samples</h1>\n\n<p>Ok, the most basic steps are done - now what?</p>\n\n<p>To get a feeling about what is possible and what not, you should install the <a href=\"https://apps.microsoft.com/detail/9P3JFPWWDZRC?\">WinUI 3 Gallery</a> app.</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2024-02-12/winuisample.png\" alt=\"x\" title=\"WinUI 3 Gallery\" /></p>\n\n<p>This application should give a some guidiance.</p>\n\n<p>Hope this helps!</p>\n\n<p><em>Note: I‚Äôm a beginner with WinUI 3 and just want to show other people the first few steps - if I miss something, just write me a comment! Thanks &lt;3</em></p>\n\n","Href":"https://blog.codeinside.eu/2024/02/12/first-steps-with-winui3/","RawContent":null,"Thumbnail":null},{"Title":"How Windows locates an executable via PATH or App Paths","PublishedOn":"2024-01-17T23:55:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<p>If you‚Äôve ever worked with the Windows operating system, especially in a programming context, you might have used the <code class=\"language-plaintext highlighter-rouge\">Process.Start(yourapp)</code> (e.g. <code class=\"language-plaintext highlighter-rouge\">Process.Start(Outlook)</code>) method in languages like C#.\nThis method is used to start a process - essentially to run an executable file. But have you ever stopped to think about how Windows knows where to find the executables you‚Äôre trying to run? Let‚Äôs dive into the inner workings of Windows and uncover this mystery.</p>\n\n<h1 id=\"understanding-the-path-environment-variable\">Understanding the PATH Environment Variable</h1>\n\n<p>One of the first things that come into play is the <code class=\"language-plaintext highlighter-rouge\">PATH</code> environment variable. This variable is crucial for the operating system to locate the executables.</p>\n\n<p><strong>What is the PATH Variable?</strong></p>\n\n<p>The <code class=\"language-plaintext highlighter-rouge\">PATH</code> environment variable is a system-wide or user-specific setting that lists directories where executable files are stored. When you run a command in the command prompt or use <code class=\"language-plaintext highlighter-rouge\">Process.Start(...)</code>, Windows looks through these directories to find the executable file.</p>\n\n<p>The <code class=\"language-plaintext highlighter-rouge\">PATH</code> environment variable can be viewed via the system settings:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2024-01-17/environmentsettings.png\" alt=\"x\" title=\"System Settings\" /></p>\n\n<p>‚Ä¶ there is also a nice editor now build into Windows for the <code class=\"language-plaintext highlighter-rouge\">PATH</code> environment variable:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2024-01-17/pathedit.png\" alt=\"x\" title=\"Path Edit\" /></p>\n\n<p><strong>How Does PATH Work?</strong></p>\n\n<p>If the executable is not in the current directory, Windows searches through each directory specified in the <code class=\"language-plaintext highlighter-rouge\">PATH</code> variable. The order of directories in <code class=\"language-plaintext highlighter-rouge\">PATH</code> is important - Windows searches them in the order they are listed. If it finds the executable in one of these directories, it runs it.</p>\n\n<p>However, the <code class=\"language-plaintext highlighter-rouge\">PATH</code> variable isn‚Äôt the only mechanism at play here.</p>\n\n<h1 id=\"the-role-of-app-paths-in-the-windows-registry\">The Role of App Paths in the Windows Registry</h1>\n\n<p>Another less-known but equally important component is the ‚Äú<strong><a href=\"https://learn.microsoft.com/en-us/windows/win32/shell/app-registration\">App Paths</a></strong>‚Äù registry key. This key is located in <code class=\"language-plaintext highlighter-rouge\">HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths</code>.</p>\n\n<p><strong>Understanding App Paths</strong></p>\n\n<p>The <code class=\"language-plaintext highlighter-rouge\">App Paths</code> key is used to specify paths to specific applications. Each application can have its entry under the <code class=\"language-plaintext highlighter-rouge\">App Paths</code> key, which means that Windows can find and run these applications even if their directories are not listed in the <code class=\"language-plaintext highlighter-rouge\">PATH</code> variable.</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2024-01-17/apppaths.png\" alt=\"x\" title=\"App path\" /></p>\n\n<p><strong>How Do App Paths Work?</strong></p>\n\n<p>When you use <code class=\"language-plaintext highlighter-rouge\">Process.Start(...)</code> and specify an application name like ‚ÄúOUTLOOK‚Äù, Windows first checks the App Paths registry key before it checks the <code class=\"language-plaintext highlighter-rouge\">PATH</code> variable. If it finds an entry for the application here, it uses this path to start the application. This is particularly useful for applications that are not in common directories or have multiple executables in different locations.</p>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>Both <code class=\"language-plaintext highlighter-rouge\">PATH</code> and <code class=\"language-plaintext highlighter-rouge\">App Paths</code> play significant roles. While <code class=\"language-plaintext highlighter-rouge\">PATH</code> is great for general-purpose directory searching (especially for system utilities and command-line tools), <code class=\"language-plaintext highlighter-rouge\">App Paths</code> is more specific and tailored for individual applications.</p>\n\n<p>There are probably even more options out there besides <code class=\"language-plaintext highlighter-rouge\">PATH</code> and <code class=\"language-plaintext highlighter-rouge\">App Paths</code> - Windows is full of hidden gems like this üòâ.</p>\n\n<p>Fun fact: I only discovered <code class=\"language-plaintext highlighter-rouge\">App Paths</code> while debugging a problem. We use <code class=\"language-plaintext highlighter-rouge\">Process.Start(OUTLOOK)</code> to start Microsofts Outlook Client and I was wondering why this even works.</p>\n\n<p>Hope this helps!</p>\n","Href":"https://blog.codeinside.eu/2024/01/17/windows-path-and-app-paths/","RawContent":null,"Thumbnail":null},{"Title":".NET ('.NET Core') and Proxy Settings","PublishedOn":"2024-01-12T22:55:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<p>If your .NET (‚Äú.NET Core‚Äù) program is running on a system that specifies strict proxy settings, you must either handle these settings in your application itself or use these environment variables.</p>\n\n<p>Since I had this problem from time to time and the procedure was not 100% clear to me, I am now recording it here on the blog.</p>\n\n<p><strong>‚ÄúDefaultProxy‚Äù</strong></p>\n\n<p>If you don‚Äôt specify any proxy, then the <code class=\"language-plaintext highlighter-rouge\">DefaultProxy</code> is used and depending on your operation system the following will be used:</p>\n\n<p>(Copied from <a href=\"https://learn.microsoft.com/en-us/dotnet/api/system.net.http.httpclient.defaultproxy?view=net-8.0\">here</a>)</p>\n\n<blockquote>\n  <p>For Windows: Reads proxy configuration from environment variables or, if those are not defined, from the user‚Äôs proxy settings.</p>\n\n  <p>For macOS: Reads proxy configuration from environment variables or, if those are not defined, from the system‚Äôs proxy settings.</p>\n\n  <p>For Linux: Reads proxy configuration from environment variables or, in case those are not defined, this property initializes a non-configured instance that bypasses all addresses.\nThe environment variables used for DefaultProxy initialization on Windows and Unix-based platforms are:</p>\n\n  <p>HTTP_PROXY: the proxy server used on HTTP requests.\nHTTPS_PROXY: the proxy server used on HTTPS requests.\nALL_PROXY: the proxy server used on HTTP and/or HTTPS requests in case HTTP_PROXY and/or HTTPS_PROXY are not defined.\nNO_PROXY: a comma-separated list of hostnames that should be excluded from proxying. Asterisks are not supported for wildcards; use a leading dot in case you want to match a subdomain. Examples: &gt; NO_PROXY=.example.com (with leading dot) will match www.example.com, but will not match example.com. NO_PROXY=example.com (without leading dot) will not match www.example.com. This behavior might be &gt; revisited in the future to match other ecosystems better.</p>\n</blockquote>\n\n<p><strong>Scenario: Web-App that needs external &amp; ‚Äúinternal‚Äù Web-APIs</strong></p>\n\n<p>We often had the following problem: \nOur web application needs to contact external services. This means, that we <strong>must use</strong> the proxy.\nAt the same time, our web application also wants to communicate with other web APIs on the same machine, but the proxy does not allow this (the proxy can‚Äôt return the request to the same machine - not sure why).</p>\n\n<p>It should be noted that the ‚ÄúIIS account‚Äù or ‚ÄúNetwork Service‚Äù did NOT have a proxy setting itself, i.e. the ‚ÄúUser Proxy Settings‚Äù were always empty.</p>\n\n<p><strong>Solution:</strong></p>\n\n<p>We used the following proxy settings and it worked:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>ALL_PROXY = proxyserver.corp.acme.com\nNO_Proxy = internalserver.corp.acme.com\n</code></pre></div></div>\n\n<p>Our web application and our internal web api were running on ‚Äúinternalserver.corp.acme.com‚Äù. Each request to external services were routed through the proxy and each ‚Äúinternal‚Äù request didn‚Äôt touch the proxy.</p>\n\n<p><strong>IE-Proxy Settings:</strong></p>\n\n<p>This solution should work fine on ‚ÄúServer-Environments‚Äù. If you have a desktop application, then the ‚ÄúDefault Proxy‚Äù handling should do the trick. In some special cases the ‚ÄúIE proxy setting‚Äù handling might be needed. If you want to learn more about this, read this blogpost: <a href=\"https://blog.codeinside.eu/2022/03/28/how-to-use-ie-proxy-settings-with-httpclient/\">How to use IE proxy settings with HttpClient</a>.</p>\n\n<p>Hope this helps!</p>\n","Href":"https://blog.codeinside.eu/2024/01/12/dotnetcore-and-proxy-settings/","RawContent":null,"Thumbnail":null},{"Title":"Limit Active Directory property access","PublishedOn":"2023-09-20T23:55:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<p><strong>Be aware:</strong> I‚Äôm not a full time administrator and this post might sound stupid to you.</p>\n\n<h1 id=\"the-problem\">The Problem</h1>\n\n<p>We access certain Active Directory properties with our application and on one customer domain we couldn‚Äôt get any data out via our Active Directory component.</p>\n\n<h1 id=\"solution\">Solution</h1>\n\n<p>After some debugging and doubts about our functionality we (the admin of the customer and me) found the reason:\nOur code was running under a Windows Account that was very limted and couldn‚Äôt read those properties.</p>\n\n<p>If you have similar problems you might want to take a look in the AD User &amp; Group management.</p>\n\n<ol>\n  <li>You need to active the advanced features:</li>\n</ol>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-09-20/advanced_features.png\" alt=\"x\" title=\"Advanced Features\" /></p>\n\n<ol>\n  <li>Now check the security tab, go to advanced view and add a new permission or change a existing one:</li>\n</ol>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-09-20/settings.png\" alt=\"x\" title=\"Settings\" /></p>\n\n<ol>\n  <li>Here you should be able to see a huge dialog with <strong>all available properties</strong>. Check if your user is able to read your target property</li>\n</ol>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-09-20/details.png\" alt=\"x\" title=\"Details\" /></p>\n\n<p>Hope this helps!</p>\n","Href":"https://blog.codeinside.eu/2023/09/20/limit-active-directory-property-access/","RawContent":null,"Thumbnail":null},{"Title":"Zip deployment failed on Azure","PublishedOn":"2023-09-05T23:55:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<h1 id=\"the-problem\">The Problem</h1>\n\n<p>We are using <a href=\"https://learn.microsoft.com/en-us/azure/app-service/\">Azure App Service</a> for our application (which runs great BTW) and deploy it automatically via <a href=\"https://learn.microsoft.com/en-us/azure/app-service/deploy-zip\">ZipDeploy</a>. \nThis basic setup was running smoth, but we noticed that at some point the deployment failed with these error messages:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>2023-08-24T20:48:56.1057054Z Deployment endpoint responded with status code 202\n2023-08-24T20:49:15.6984407Z Configuring default logging for the app, if not already enabled\n2023-08-24T20:49:18.8106651Z Zip deployment failed. {'id': 'temp-b574d768', 'status': 3, 'status_text': '', 'author_email': 'N/A', 'author': 'N/A', 'deployer': 'ZipDeploy', 'message': 'Deploying from pushed zip file', 'progress': '', 'received_time': '2023-08-24T20:48:55.8916655Z', 'start_time': '2023-08-24T20:48:55.8916655Z', 'end_time': '2023-08-24T20:49:15.3291017Z', 'last_success_end_time': None, 'complete': True, 'active': False, 'is_temp': True, 'is_readonly': False, 'url': 'https://[...].scm.azurewebsites.net/api/deployments/latest', 'log_url': 'https://[...].scm.azurewebsites.net/api/deployments/latest/log', 'site_name': '[...]', 'provisioningState': 'Failed'}. Please run the command az webapp log deployment show\n2023-08-24T20:49:18.8114319Z                            -n [...] -g production\n</code></pre></div></div>\n\n<p>or this one (depending on how we invoked the deployment script):</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>Getting scm site credentials for zip deployment\nStarting zip deployment. This operation can take a while to complete ...\nDeployment endpoint responded with status code 500\nAn error occured during deployment. Status Code: 500, Details: {\"Message\":\"An error has occurred.\",\"ExceptionMessage\":\"There is not enough space on the disk.\\r\\n\",\"ExceptionType\":\"System.IO.IOException\",\"StackTrace\":\" \n</code></pre></div></div>\n\n<h1 id=\"there-is-not-enough-space-on-the-disk\">‚ÄúThere is not enough space on the disk‚Äù?</h1>\n\n<p>The message <code class=\"language-plaintext highlighter-rouge\">There is not enough space on the disk</code> was a good hint, but according to the File system storage everything should be fine with only 8% used.</p>\n\n<p>Be aware - this is important: We have multiple apps on the same App Service plan!</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-09-05/file-system-storage.png\" alt=\"x\" title=\"File System Storage\" /></p>\n\n<h1 id=\"kudu-to-the-rescure\">Kudu to the rescure</h1>\n\n<p>Next step was to check the behind the scene environment via the ‚ÄúAdvanced Tools‚Äù Kudu and there it is:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-09-05/kudu.png\" alt=\"x\" title=\"Kudu local Storage\" /></p>\n\n<p>There are two different storages attached to the app service:</p>\n\n<ul>\n  <li><code class=\"language-plaintext highlighter-rouge\">c:\\home</code> is the ‚ÄúFile System Storage‚Äù that you can see in the Azure Portal and is quite large. App files are located here.</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">c:\\local</code> is a <strong>much</strong> smaller storage with ~21GB and if the space is used, then ZipDeploy will fail.</li>\n</ul>\n\n<h1 id=\"who-is-using-this-space\">Who is using this space?</h1>\n\n<p><code class=\"language-plaintext highlighter-rouge\">c:\\local</code> stores ‚Äúmostly‚Äù temporarily items, e.g.:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>Directory of C:\\local\n\n08/31/2023  06:40 AM    &lt;DIR&gt;          .\n08/31/2023  06:40 AM    &lt;DIR&gt;          ..\n07/13/2023  04:29 PM    &lt;DIR&gt;          AppData\n07/13/2023  04:29 PM    &lt;DIR&gt;          ASP Compiled Templates\n08/31/2023  06:40 AM    &lt;DIR&gt;          Config\n07/13/2023  04:29 PM    &lt;DIR&gt;          DomainValidationTokens\n07/13/2023  04:29 PM    &lt;DIR&gt;          DynamicCache\n07/13/2023  04:29 PM    &lt;DIR&gt;          FrameworkJit\n07/13/2023  04:29 PM    &lt;DIR&gt;          IIS Temporary Compressed Files\n07/13/2023  04:29 PM    &lt;DIR&gt;          LocalAppData\n07/13/2023  04:29 PM    &lt;DIR&gt;          ProgramData\n09/05/2023  08:36 PM    &lt;DIR&gt;          Temp\n08/31/2023  06:40 AM    &lt;DIR&gt;          Temporary ASP.NET Files\n07/18/2023  04:06 AM    &lt;DIR&gt;          UserProfile\n08/19/2023  06:34 AM    &lt;SYMLINKD&gt;     VirtualDirectory0 [\\\\...\\]\n               0 File(s)              0 bytes\n              15 Dir(s)  13,334,384,640 bytes free\n</code></pre></div></div>\n\n<p>The ‚Äúbiggest‚Äù item here was in our case under <code class=\"language-plaintext highlighter-rouge\">c:\\local\\Temp\\zipdeploy</code>:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code> Directory of C:\\local\\Temp\\zipdeploy\n\n08/29/2023  04:52 AM    &lt;DIR&gt;          .\n08/29/2023  04:52 AM    &lt;DIR&gt;          ..\n08/29/2023  04:52 AM    &lt;DIR&gt;          extracted\n08/29/2023  04:52 AM       774,591,927 jiire5i5.zip\n</code></pre></div></div>\n\n<p>This folder stores our <code class=\"language-plaintext highlighter-rouge\">ZipDeploy</code> package, which is quite large with ~800MB. The folder also contains the extracted files - remember: We only have 21GB on this storage, but even if this zip file and the extracted files are ~3GB, there is still plenty of room, right?</p>\n\n<h1 id=\"shared-resources\">Shared resources</h1>\n\n<p>Well‚Ä¶ it turns out, that <strong>each App Service</strong> on a <strong>App Service plan</strong> is using this storage and if you have multiple App Services on the same plan, than those 21GB might melt away.</p>\n\n<p>The ‚Äúbad‚Äù part is, that the space is shared, but each App Services has it‚Äôs own <code class=\"language-plaintext highlighter-rouge\">c:\\local</code> folder (which makes sense). To free up memory we had to clean up this folder on each App Service like that:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>rmdir c:\\local\\Temp\\zipdeploy /s /q\n</code></pre></div></div>\n\n<h1 id=\"tldr\">TL;DR</h1>\n\n<p>If you have problems with ZipDeploy and the error message tells you, that there is not enough space, check out the <code class=\"language-plaintext highlighter-rouge\">c:\\local</code> space (and of course <code class=\"language-plaintext highlighter-rouge\">c:\\home</code> as well) and delete unused files. Sometimes a reboot might help as well (to clean up temp-files), but AFAIK those ZipDeploy files will survive that.</p>\n\n","Href":"https://blog.codeinside.eu/2023/09/05/zip-deployment-failed-on-azure-and-how-to-fix-it/","RawContent":null,"Thumbnail":null},{"Title":"First steps with Azure OpenAI and .NET","PublishedOn":"2023-03-23T23:55:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<p>The AI world is rising very fast these days: <a href=\"https://chat.openai.com/\">ChatGPT</a> is such an awesome (and scary good?) service and Microsoft <a href=\"https://blogs.microsoft.com/blog/2023/01/23/microsoftandopenaiextendpartnership/\">joined the ship with some partner announcements and investments</a>. The result is of these actions is, that OpenAI is now a ‚Äúfirst class citizen‚Äù on Azure.</p>\n\n<p>So - for the average Microsoft/.NET developer this opens up a wonderful toolbox and the first steps are really easy.</p>\n\n<p><strong>Be aware:</strong> You need to <a href=\"https://customervoice.microsoft.com/Pages/ResponsePage.aspx?id=v4j5cvGGr0GRqy180BHbR7en2Ais5pxKtso_Pz4b1_xUOFA5Qk1UWDRBMjg0WFhPMkIzTzhKQ1dWNyQlQCN0PWcu\">‚Äúapply‚Äù to access the OpenAI service</a>, but it took less then 24 hours for us to gain access to the service. I guess this is just a temporary thing.</p>\n\n<p><strong>Disclaimer:</strong> I‚Äôm not an AI/ML engineer and I only have a very ‚Äúglimpse‚Äù knowledge about the technology behind GPT3, ChatGPT and ML in general. If in doubt, I always ask my buddy <a href=\"https://www.oliverguhr.eu/\">Oliver Guhr</a>, because he is much smarter in this stuff. Follow him on <a href=\"https://twitter.com/oliverguhr\">Twitter</a>!</p>\n\n<h1 id=\"1-step-go-to-azure-openai-service\">1. Step: Go to Azure OpenAI Service</h1>\n\n<p>Search for ‚ÄúOpenAI‚Äù and you will see the ‚ÄúAzure OpenAI Service‚Äù entry:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-03-23/openai-service.png\" alt=\"x\" title=\"Step 1\" /></p>\n\n<h1 id=\"2-step-create-a-azure-openai-service-instance\">2. Step: Create a Azure OpenAI Service instance</h1>\n\n<p>Create a new Azure OpenAI Service instance:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-03-23/create.png\" alt=\"x\" title=\"Step 2\" /></p>\n\n<p>On the next page you will need to enter the subscription, resource group, region and a name (typical Azure stuff):</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-03-23/create-details.png\" alt=\"x\" title=\"Step 2 - details\" /></p>\n\n<p><strong>Be aware:</strong> If your subscription is not enabled for OpenAI, you need to <a href=\"https://customervoice.microsoft.com/Pages/ResponsePage.aspx?id=v4j5cvGGr0GRqy180BHbR7en2Ais5pxKtso_Pz4b1_xUOFA5Qk1UWDRBMjg0WFhPMkIzTzhKQ1dWNyQlQCN0PWcu\">apply here</a> first.</p>\n\n<h1 id=\"3-step-overview-and-create-a-model\">3. Step: Overview and create a model</h1>\n\n<p>After the service is created you should see something like this:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-03-23/overview.png\" alt=\"x\" title=\"Step 3 - overview\" /></p>\n\n<p>Now go to ‚ÄúModel deployments‚Äù and create a model - I choosed ‚Äútext-davinci-003‚Äù, because I <em>think</em> this is GPT3.5 (which was the initial ChatGPT release, GPT4 is currently in preview for Azure and you need to <a href=\"https://azure.microsoft.com/en-us/blog/introducing-gpt4-in-azure-openai-service/\">apply again</a>.</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-03-23/model.png\" alt=\"x\" title=\"Step 3 - model\" /></p>\n\n<p>My guess is, that you could train/deploy other, specialized models here, because this model is quite complex and you might want to tailor the model for your scenario to get faster/cheaper results‚Ä¶ but I honestly don‚Äôt know how to do it (currently), so we just leave the default.</p>\n\n<h1 id=\"4-step-get-the-endpoint-and-the-key\">4. Step: Get the endpoint and the key</h1>\n\n<p>In this step we just need to copy the key and the endpoint, which can be found under ‚ÄúKeys and Endpoint‚Äù, simple - right?</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-03-23/keys-and-endpoint.png\" alt=\"x\" title=\"Step 4\" /></p>\n\n<h1 id=\"5-step-hello-world-to-our-azure-openai-instance\">5. Step: Hello World to our Azure OpenAI instance</h1>\n\n<p>Create a .NET application and add the <a href=\"https://www.nuget.org/packages/Azure.AI.OpenAI/\">Azure.AI.OpenAI</a> NuGet package (currently in preview!).</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>dotnet add package Azure.AI.OpenAI --version 1.0.0-beta.5\n</code></pre></div></div>\n\n<p>Use this code:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>using Azure.AI.OpenAI;\nusing Azure;\n\nConsole.WriteLine(\"Hello, World!\");\n\nOpenAIClient client = new OpenAIClient(\n        new Uri(\"YOUR-ENDPOINT\"),\n        new AzureKeyCredential(\"YOUR-KEY\"));\n\nstring deploymentName = \"text-davinci-003\";\nstring prompt = \"Tell us something about .NET development.\";\nConsole.Write($\"Input: {prompt}\");\n\nResponse&lt;Completions&gt; completionsResponse = client.GetCompletions(deploymentName, prompt);\nstring completion = completionsResponse.Value.Choices[0].Text;\n\nConsole.WriteLine(completion);\n\nConsole.ReadLine();\n\n</code></pre></div></div>\n\n<p><strong>Result:</strong></p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>Hello, World!\nInput: Tell us something about .NET development.\n\n.NET development is a mature, feature-rich platform that enables developers to create sophisticated web applications, services, and applications for desktop, mobile, and embedded systems. Its features include full-stack programming, object-oriented data structures, security, scalability, speed, and an open source framework for distributed applications. A great advantage of .NET development is its capability to develop applications for both Windows and Linux (using .NET Core). .NET development is also compatible with other languages such as\n</code></pre></div></div>\n\n<p>As you can see‚Ä¶ the result is cut off, not sure why, but this is just a simple demonstration.</p>\n\n<h1 id=\"summary\">Summary</h1>\n\n<p>With these basic steps you can access the OpenAI development world. Azure makes it easy to integrate in your existing Azure/Microsoft ‚Äústack‚Äù. Be aware, that you could also use the same SDK and use the endpoint from OpenAI. Because of billing reasons it is easier for us to use the Azure hosted instances.</p>\n\n<p>Hope this helps!</p>\n\n<h1 id=\"video-on-my-youtube-channel\">Video on my YouTube Channel</h1>\n\n<p>If you understand German and want to see it in action, check out my video on my <a href=\"https://www.youtube.com/@CodeInsideCasts\">Channel</a>:</p>\n\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/VVNHT4gVxDo\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" allowfullscreen=\"\"></iframe>\n\n","Href":"https://blog.codeinside.eu/2023/03/23/first-steps-with-azure-openai-and-dotnet/","RawContent":null,"Thumbnail":null},{"Title":"How to fix: 'Microsoft.ACE.OLEDB.12.0' provider is not registered on the local machine","PublishedOn":"2023-03-18T23:55:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<p>In our product we can interact with different datasource and one of these datasources was a Microsoft Access DB connected via <code class=\"language-plaintext highlighter-rouge\">OLEDB</code>. This is really, really old, but still works, but on one customer machine we had this issue:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>'Microsoft.ACE.OLEDB.12.0' provider is not registered on the local machine\n</code></pre></div></div>\n\n<h1 id=\"solution\">Solution</h1>\n\n<p>If you face this issue, you need to install the provider from <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=13255\">here</a>.</p>\n\n<p><strong>Be aware:</strong> If you have a different error, you might need to install the newer provider - this is labled as ‚Äú2010 Redistributable‚Äù, but still works with all those fancy Office 365 apps out there.</p>\n\n<p><strong>Important:</strong> You need to install the provider in the correct bit version, e.g. if you run under x64, install the x64.msi.</p>\n\n<p>The solution comes from this <a href=\"https://stackoverflow.com/questions/6649363/microsoft-ace-oledb-12-0-provider-is-not-registered-on-the-local-machine\">Stackoverflow question</a>.</p>\n\n<h1 id=\"helper\">Helper</h1>\n\n<p>The best tip from Stackoverflow was these powershell commands to check, if the provider is there or not:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>(New-Object system.data.oledb.oledbenumerator).GetElements() | select SOURCES_NAME, SOURCES_DESCRIPTION \n\nGet-OdbcDriver | select Name,Platform\n</code></pre></div></div>\n\n<p>This will return something like this:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>PS C:\\Users\\muehsig&gt; (New-Object system.data.oledb.oledbenumerator).GetElements() | select SOURCES_NAME, SOURCES_DESCRIPTION\n\nSOURCES_NAME               SOURCES_DESCRIPTION\n------------               -------------------\nSQLOLEDB                   Microsoft OLE DB Provider for SQL Server\nMSDataShape                MSDataShape\nMicrosoft.ACE.OLEDB.12.0   Microsoft Office 12.0 Access Database Engine OLE DB Provider\nMicrosoft.ACE.OLEDB.16.0   Microsoft Office 16.0 Access Database Engine OLE DB Provider\nADsDSOObject               OLE DB Provider for Microsoft Directory Services\nWindows Search Data Source Microsoft OLE DB Provider for Search\nMSDASQL                    Microsoft OLE DB Provider for ODBC Drivers\nMSDASQL Enumerator         Microsoft OLE DB Enumerator for ODBC Drivers\nSQLOLEDB Enumerator        Microsoft OLE DB Enumerator for SQL Server\nMSDAOSP                    Microsoft OLE DB Simple Provider\n\n\nPS C:\\Users\\muehsig&gt; Get-OdbcDriver | select Name,Platform\n\nName                                                   Platform\n----                                                   --------\nDriver da Microsoft para arquivos texto (*.txt; *.csv) 32-bit\nDriver do Microsoft Access (*.mdb)                     32-bit\nDriver do Microsoft dBase (*.dbf)                      32-bit\nDriver do Microsoft Excel(*.xls)                       32-bit\nDriver do Microsoft Paradox (*.db )                    32-bit\nMicrosoft Access Driver (*.mdb)                        32-bit\nMicrosoft Access-Treiber (*.mdb)                       32-bit\nMicrosoft dBase Driver (*.dbf)                         32-bit\nMicrosoft dBase-Treiber (*.dbf)                        32-bit\nMicrosoft Excel Driver (*.xls)                         32-bit\nMicrosoft Excel-Treiber (*.xls)                        32-bit\nMicrosoft ODBC for Oracle                              32-bit\nMicrosoft Paradox Driver (*.db )                       32-bit\nMicrosoft Paradox-Treiber (*.db )                      32-bit\nMicrosoft Text Driver (*.txt; *.csv)                   32-bit\nMicrosoft Text-Treiber (*.txt; *.csv)                  32-bit\nSQL Server                                             32-bit\nODBC Driver 17 for SQL Server                          32-bit\nSQL Server                                             64-bit\nODBC Driver 17 for SQL Server                          64-bit\nMicrosoft Access Driver (*.mdb, *.accdb)               64-bit\nMicrosoft Excel Driver (*.xls, *.xlsx, *.xlsm, *.xlsb) 64-bit\nMicrosoft Access Text Driver (*.txt, *.csv)            64-bit\n</code></pre></div></div>\n\n<p>Hope this helps! (And I hope you don‚Äôt need to deal with these ancient technologies for too long üòÖ)</p>\n","Href":"https://blog.codeinside.eu/2023/03/18/microsoft-ace-oledb-12-0-provider-is-not-registered/","RawContent":null,"Thumbnail":null},{"Title":"Resource type is not supported in this subscription","PublishedOn":"2023-03-11T23:55:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<p>I was playing around with some Visual Studio Tooling and noticed this error during the creation of a ‚ÄúAzure Container Apps‚Äù-app:</p>\n\n<p><code class=\"language-plaintext highlighter-rouge\">Resource type is not supported in this subscription</code></p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-03-11/error.png\" alt=\"x\" title=\"Error\" /></p>\n\n<h1 id=\"solution\">Solution</h1>\n\n<p>The solution is quite strange at first, but in the super configurable world of Azure it makes sense: You need to activate the <a href=\"https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/resource-providers-and-types\"><strong>Resource provider</strong></a> for this feature on your subscription. For <code class=\"language-plaintext highlighter-rouge\">Azure Container Apps</code> you need the <code class=\"language-plaintext highlighter-rouge\">Microsoft.ContainerRegistry</code>-resource provider <strong>registered</strong>:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-03-11/solution.png\" alt=\"x\" title=\"Solution\" /></p>\n\n<p>It seems, that you can create such resources via the Portal, but if you go via the API (which Visual Studio seems to do) the provider needs to be registered at first.</p>\n\n<p>Some resource providers are ‚Äúenabled by default‚Äù, other providers needs to be turned on manually. Check out this list for a list of <a href=\"https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/azure-services-resource-providers\">all resource providers and the related Azure service</a>.</p>\n\n<p><strong>Be careful:</strong> I guess you should only enable the resource providers that you really need, otherwise your attack surface will get larger.</p>\n\n<p>To be honest: This was completly new for me - I do Azure since ages and never had to deal with resource providers. Always learning ;)</p>\n\n<p>Hope this helps!</p>\n","Href":"https://blog.codeinside.eu/2023/03/11/resource-type-is-not-supported-in-this-subscription/","RawContent":null,"Thumbnail":null},{"Title":"Azure DevOps Server 2022 Update","PublishedOn":"2023-02-15T23:15:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<h1 id=\"azure-devops-server-2022---onprem\">Azure DevOps Server 2022 - OnPrem?</h1>\n\n<p>Yes I know - you can get everything from the cloud nowadays, but <a href=\"https://primesoft-group.com/\">we</a> are still using our OnPrem hardware and were running the ‚Äúold‚Äù <a href=\"https://blog.codeinside.eu/2020/11/30/update-onprem-azuredevops-server-2019-to-azuredevops-server-2019-update1/\">Azure DevOps Server 2020</a>. \nThe <em>_Azure DevOps Server 2022</em> was released <a href=\"https://learn.microsoft.com/en-us/azure/devops/server/release-notes/azuredevops2022?view=azure-devops-2022\">last december</a>, so an update was due.</p>\n\n<h1 id=\"requirements\">Requirements</h1>\n\n<p>If you are running am Azure DevOps Server 2020 the <a href=\"https://learn.microsoft.com/en-us/azure/devops/server/requirements?view=azure-devops-2022&amp;viewFallbackFrom=azure-devops\">requirements</a> for the new 2022 release are ‚Äúmore or less‚Äù the same <strong>except</strong> the following important parts:</p>\n\n<ul>\n  <li>Supported server operation systems: <strong>Windows Server 2022 &amp; Windows Server 2019</strong> vs. the old Azure DevOps Server 2020 could run under a Windows Server 2016</li>\n  <li>Supported SQL Server versions: <strong>Azure SQL Database, SQL Managed Instance, SQL Server 2019, SQL Server 2017</strong> vs. the old Azure DevOps Server supported SQL Server 2016.</li>\n</ul>\n\n<h1 id=\"make-sure-you-have-a-backup\">Make sure you have a backup</h1>\n\n<p>The last requirement was a suprise for me, because I thought the update should run smoothly, but the installer removed the previous version and I couldn‚Äôt update, because our SQL Server was still on SQL Server 2016. Fortunately we had a VM backup and could rollback to the previous version.</p>\n\n<h1 id=\"step-for-step\">Step for Step</h1>\n\n<p>The update process itself was straightforward: Download the <a href=\"https://learn.microsoft.com/en-us/azure/devops/server/download/azuredevopsserver?view=azure-devops-2022\">installer</a> and run it.</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-02-15/step1.png\" alt=\"x\" title=\"Step 1\" /></p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-02-15/step2.png\" alt=\"x\" title=\"Step 2\" /></p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-02-15/step3.png\" alt=\"x\" title=\"Step 3\" /></p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-02-15/step4.png\" alt=\"x\" title=\"Step 4\" /></p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-02-15/step5.png\" alt=\"x\" title=\"Step 5\" /></p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-02-15/step6.png\" alt=\"x\" title=\"Step 6\" /></p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-02-15/step7.png\" alt=\"x\" title=\"Step 7\" /></p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-02-15/step8.png\" alt=\"x\" title=\"Step 8\" /></p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-02-15/step9.png\" alt=\"x\" title=\"Step 9\" /></p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-02-15/step10.png\" alt=\"x\" title=\"Step 10\" /></p>\n\n<p><em>The screenshots are from two different sessions. If you look carefully on the clock you might see that the date is different, that is because of the SQL Server 2016 problem.</em></p>\n\n<p>As you can see - everything worked as expected, but after we updated the server the search, which is powered by ElasticSearch was not working. The ‚ÄúElasticSearch‚Äù-Windows-Service just crashed on startup and I‚Äôm not a Java guy, so‚Ä¶ we fixed it by removing the search feature and reinstall it. \nWe tried to clean the cache, but it was still not working. After the reinstall of this feature the issue went away.</p>\n\n<h1 id=\"features\">Features</h1>\n\n<p>Azure Server 2022 is just a minor update (at least from a typical user perspective). The biggest new feature might be ‚ÄúDelivery Plans‚Äù, which are nice, but for small teams not a huge benefit. Check out the <a href=\"https://learn.microsoft.com/en-us/azure/devops/server/release-notes/azuredevops2022?view=azure-devops#azure-devops-server-2022-rc1-release-date-august-9-2022\">release notes</a>.</p>\n\n<p>A nice - nerdy - enhancement, and not mentioned in the release notes: ‚Äú<a href=\"https://mermaid.js.org/\">mermaid.js</a>‚Äù is now supported in the Azure DevOps Wiki, yay!</p>\n\n<p>Hope this helps!</p>\n","Href":"https://blog.codeinside.eu/2023/02/15/azure-devops-server-2022-update/","RawContent":null,"Thumbnail":null},{"Title":"Use ASP.NET Core and React with Vite.js","PublishedOn":"2023-02-11T01:15:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<h1 id=\"the-cra-problem\">The CRA Problem</h1>\n\n<p>In my <a href=\"https://blog.codeinside.eu/2023/01/25/aspnet-core-and-react/\">previous post</a> I showed a simple setup with ASP.NET Core &amp; React. The React part was created with the ‚ÄúCRA‚Äù-Tooling, which is kind of <a href=\"https://twitter.com/t3dotgg/status/1616918838830059520\">problematic</a>. The ‚Äúnew‚Äù state of the art React tooling seems to be <a href=\"https://vitejs.dev/\">vite.js</a> - so let‚Äôs take a look how to use this.</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-02-11/vitejs.png\" alt=\"x\" title=\"Vitejs Logo\" /></p>\n\n<h1 id=\"step-for-step\">Step for Step</h1>\n\n<p><strong>Step 1: Create a ‚Äúnormal‚Äù ASP.NET Core project</strong></p>\n\n<p>(I like the ASP.NET Core MVC template, but feel free to use something else - same as in the <a href=\"https://blog.codeinside.eu/2023/01/25/aspnet-core-and-react/\">other blogpost</a>)</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-02-11/step1.png\" alt=\"x\" title=\"Step 1: Create a normal ASPNET Core project\" /></p>\n\n<p><strong>Step 2: Install vite.js and init the template</strong></p>\n\n<p>Now move to the root directory of your project with a shell and execute this:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>npm create vite@latest clientapp -- --template react-ts\n</code></pre></div></div>\n\n<p>This will install the latest &amp; greatest vitejs based react app in a folder called <code class=\"language-plaintext highlighter-rouge\">clientapp</code> with the <code class=\"language-plaintext highlighter-rouge\">react-ts</code> template (React with Typescript). Vite itself isn‚Äôt focused on React and supports many <a href=\"https://vitejs.dev/guide/#trying-vite-online\">different frontend frameworks</a>.</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-02-11/step2.png\" alt=\"x\" title=\"Step 2: Init vitejs\" /></p>\n\n<p><strong>Step 3: Enable HTTPS in your vite.js</strong></p>\n\n<p>Just like in the ‚ÄúCRA‚Äù-setup we need to make sure, that the environment is served under HTTPS. In the ‚ÄúCRA‚Äù world we needed to different files from the original ASP.NET Core &amp; React template, but with vite.js there is a much simpler option available.</p>\n\n<p>Execute the following command in the <code class=\"language-plaintext highlighter-rouge\">clientapp</code> directory:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>npm install --save-dev vite-plugin-mkcert\n</code></pre></div></div>\n\n<p>Then in your <code class=\"language-plaintext highlighter-rouge\">vite.config.ts</code> use this config:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>import { defineConfig } from 'vite'\nimport react from '@vitejs/plugin-react'\nimport mkcert from 'vite-plugin-mkcert'\n\n// https://vitejs.dev/config/\nexport default defineConfig({\n    base: '/app',\n    server: {\n        https: true,\n        port: 6363\n    },\n    plugins: [react(), mkcert()],\n})\n</code></pre></div></div>\n\n<p>Be aware: The <code class=\"language-plaintext highlighter-rouge\">base: '/app'</code> will be used as a sub-path.</p>\n\n<p>The important part for the HTTPS setting is that we use the <code class=\"language-plaintext highlighter-rouge\">mkcert()</code> plugin and configure the server part with a port and set <code class=\"language-plaintext highlighter-rouge\">https</code> to <code class=\"language-plaintext highlighter-rouge\">true</code>.</p>\n\n<p><strong>Step 4: Add the Microsoft.AspNetCore.SpaServices.Extensions NuGet package</strong></p>\n\n<p>Same as in the other blogpost, we need to add the <a href=\"https://www.nuget.org/packages/Microsoft.AspNetCore.SpaServices.Extensions\">Microsoft.AspNetCore.SpaServices.Extensions</a> NuGet package to glue the ASP.NET Core development and React world together. If you use .NET 7, then use the version 7.x.x, if you use .NET 6, use the version 6.x.x - etc.</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-02-11/step4.png\" alt=\"x\" title=\"Step 4: Add NuGet Package\" /></p>\n\n<p><strong>Step 5: Enhance your Program.cs</strong></p>\n\n<p>Back to the <code class=\"language-plaintext highlighter-rouge\">Program.cs</code> - this is more or less the same as with the ‚ÄúCRA‚Äù setup:</p>\n\n<p>Add the <code class=\"language-plaintext highlighter-rouge\">SpaStaticFiles</code> to the services collection like this in your <code class=\"language-plaintext highlighter-rouge\">Program.cs</code> - be aware, that vite.js builds everything in a folder called <code class=\"language-plaintext highlighter-rouge\">dist</code>:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>var builder = WebApplication.CreateBuilder(args);\n\n// Add services to the container.\nbuilder.Services.AddControllersWithViews();\n\n// ‚Üì Add the following lines: ‚Üì\nbuilder.Services.AddSpaStaticFiles(configuration =&gt; {\n    configuration.RootPath = \"clientapp/dist\";\n});\n// ‚Üë these lines ‚Üë\n\nvar app = builder.Build();\n</code></pre></div></div>\n\n<p>Now we need to use the SpaServices like this:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>app.MapControllerRoute(\n    name: \"default\",\n    pattern: \"{controller=Home}/{action=Index}/{id?}\");\n\n// ‚Üì Add the following lines: ‚Üì\nvar spaPath = \"/app\";\nif (app.Environment.IsDevelopment())\n{\n    app.MapWhen(y =&gt; y.Request.Path.StartsWithSegments(spaPath), client =&gt;\n    {\n        client.UseSpa(spa =&gt;\n        {\n            spa.UseProxyToSpaDevelopmentServer(\"https://localhost:6363\");\n        });\n    });\n}\nelse\n{\n    app.Map(new PathString(spaPath), client =&gt;\n    {\n        client.UseSpaStaticFiles();\n        client.UseSpa(spa =&gt; {\n            spa.Options.SourcePath = \"clientapp\";\n\n            // adds no-store header to index page to prevent deployment issues (prevent linking to old .js files)\n            // .js and other static resources are still cached by the browser\n            spa.Options.DefaultPageStaticFileOptions = new StaticFileOptions\n            {\n                OnPrepareResponse = ctx =&gt;\n                {\n                    ResponseHeaders headers = ctx.Context.Response.GetTypedHeaders();\n                    headers.CacheControl = new CacheControlHeaderValue\n                    {\n                        NoCache = true,\n                        NoStore = true,\n                        MustRevalidate = true\n                    };\n                }\n            };\n        });\n    });\n}\n// ‚Üë these lines ‚Üë\n\napp.Run();\n</code></pre></div></div>\n\n<p>Just like in the original blogpost. In the development mode we use the <code class=\"language-plaintext highlighter-rouge\">UseProxyToSpaDevelopmentServer</code>-method to proxy all requests to the vite.js dev server. In the real world, we will use the files from the <code class=\"language-plaintext highlighter-rouge\">dist</code> folder.</p>\n\n<p><strong>Step 6: Invoke npm run build during publish</strong></p>\n\n<p>The last step is to complete the setup. We want to build the ASP.NET Core app <strong>and</strong> the React app, when we use <code class=\"language-plaintext highlighter-rouge\">dotnet publish</code>:</p>\n\n<p>Add this to your <code class=\"language-plaintext highlighter-rouge\">.csproj</code>-file and it should work:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>\t&lt;PropertyGroup&gt;\n\t\t&lt;SpaRoot&gt;clientapp\\&lt;/SpaRoot&gt;\n\t&lt;/PropertyGroup&gt;\n\n\t&lt;Target Name=\"PublishRunWebpack\" AfterTargets=\"ComputeFilesToPublish\"&gt;\n\t\t&lt;!-- As part of publishing, ensure the JS resources are freshly built in production mode --&gt;\n\t\t&lt;Exec WorkingDirectory=\"$(SpaRoot)\" Command=\"npm install\" /&gt;\n\t\t&lt;Exec WorkingDirectory=\"$(SpaRoot)\" Command=\"npm run build\" /&gt;\n\n\t\t&lt;!-- Include the newly-built files in the publish output --&gt;\n\t\t&lt;ItemGroup&gt;\n\t\t\t&lt;DistFiles Include=\"$(SpaRoot)dist\\**\" /&gt;  &lt;!-- Changed to dist! --&gt;\n\t\t\t&lt;ResolvedFileToPublish Include=\"@(DistFiles-&gt;'%(FullPath)')\" Exclude=\"@(ResolvedFileToPublish)\"&gt;\n\t\t\t\t&lt;RelativePath&gt;%(DistFiles.Identity)&lt;/RelativePath&gt; &lt;!-- Changed! --&gt;\n\t\t\t\t&lt;CopyToPublishDirectory&gt;PreserveNewest&lt;/CopyToPublishDirectory&gt;\n\t\t\t\t&lt;ExcludeFromSingleFile&gt;true&lt;/ExcludeFromSingleFile&gt;\n\t\t\t&lt;/ResolvedFileToPublish&gt;\n\t\t&lt;/ItemGroup&gt;\n\t&lt;/Target&gt;\n</code></pre></div></div>\n\n<h1 id=\"result\">Result</h1>\n\n<p>You should now be able to use Visual Studio Code (or something like this) and start the frontend project with <code class=\"language-plaintext highlighter-rouge\">dev</code>. If you open a browser and go to <code class=\"language-plaintext highlighter-rouge\">https://127.0.0.1:6363/app</code> you should see something like this:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-02-11/result-vscode.png\" alt=\"x\" title=\"Visual Studio Code Result\" /></p>\n\n<p>Now start the ASP.NET Core app and go to <code class=\"language-plaintext highlighter-rouge\">/app</code> and it should look like this:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-02-11/result-vs.png\" alt=\"x\" title=\"Visual Studio Result\" /></p>\n\n<p>Ok - this looks broken, right? Well - this is a more or less a <a href=\"https://github.com/vitejs/vite/issues/7358\">‚Äúknown‚Äù problem</a>, but can be easily avoided. If we import the logo from the assets it works as expected and shouldn‚Äôt be a general problem:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-02-11/result-fix.png\" alt=\"x\" title=\"Fix\" /></p>\n\n<h1 id=\"code\">Code</h1>\n\n<p>The sample code can be found <a href=\"https://github.com/Code-Inside/Samples/tree/master/2023/reactvideovite/reactvideovite\">here</a>.</p>\n\n<h1 id=\"video\">Video</h1>\n\n<p>I made a video about this topic (in German, sorry :-/) as well - feel free to subscribe ;)</p>\n\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/-2iiXpBcmDY\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" allowfullscreen=\"\"></iframe>\n\n<p>Hope this helps!</p>\n","Href":"https://blog.codeinside.eu/2023/02/11/aspnet-core-react-with-vitejs/","RawContent":null,"Thumbnail":null},{"Title":"Use ASP.NET Core & React togehter","PublishedOn":"2023-01-25T23:15:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<h1 id=\"the-aspnet-core-react-template\">The ASP.NET Core React template</h1>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-01-25/aspnetreacttemplate.png\" alt=\"x\" title=\"ASP.NET Core React template\" /></p>\n\n<p>Visual Studio (at least VS 2019 and the newer 2022) ships with a ASP.NET Core React template, which is ‚Äúok-ish‚Äù, but has some really <strong>bad problems</strong>:</p>\n\n<p>The React part of this template is scaffolded via ‚ÄúCRA‚Äù (which seems to be <a href=\"https://twitter.com/t3dotgg/status/1616918838830059520\">problematic</a> as well, but is not the point of this post) and uses <strong>JavaScript instead of TypeScript</strong>.\nAnother huge pain point (from my perspective) is that the template uses some special configurations to just host the react part for users - if you want to mix in some ‚ÄúMVC‚Äù/‚ÄùRazor‚Äù stuff, you need to change some of this ‚Äúmagic‚Äù.</p>\n\n<p>The <strong>good parts</strong>:</p>\n\n<p>Both worlds can live together: During development time the ASP.NET Core stuff is hosted via Kestrel and the React part is hosted under the WebPack Development server. The lovely hot reload is working as expected and is really powerful.\nIf you are doing a release build, the project will take care of the npm-magic.</p>\n\n<p>But because of the ‚Äúbad problems‚Äù outweight the benefits, we try to integrate a typical react app in a ‚Äúnormal‚Äù ASP.NET Core app.</p>\n\n<h1 id=\"step-for-step\">Step for Step</h1>\n\n<p><strong>Step 1: Create a ‚Äúnormal‚Äù ASP.NET Core project</strong></p>\n\n<p>(I like the ASP.NET Core MVC template, but feel free to use something else)</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-01-25/aspnetreact-step1.png\" alt=\"x\" title=\"Step 1: Create a normal ASPNET Core project\" /></p>\n\n<p><strong>Step 2: Create a react app inside the ASP.NET Core project</strong></p>\n\n<p>(For this blogpost I use the ‚ÄúCreate React App‚Äù-approach, but you can use whatever you like)</p>\n\n<p>Execute this in your ASP.NET Core template (node &amp; npm must be installed!):</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>npx create-react-app clientapp --template typescript\n</code></pre></div></div>\n\n<p><strong>Step 3: Copy some stuff from the React template</strong></p>\n\n<p>The react template ships with some scripts and settings that we want to preserve:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-01-25/aspnetreact-step3.png\" alt=\"x\" title=\"Step 3: Copy from the react template\" /></p>\n\n<p>The <code class=\"language-plaintext highlighter-rouge\">aspnetcore-https.js</code> and <code class=\"language-plaintext highlighter-rouge\">aspnetcore-react.js</code> file is needed to setup the ASP.NET Core SSL dev certificate for the WebPack Dev Server. \nYou should also copy the <code class=\"language-plaintext highlighter-rouge\">.env</code> &amp; <code class=\"language-plaintext highlighter-rouge\">.env.development</code> file in the root of your <code class=\"language-plaintext highlighter-rouge\">clientapp</code>-folder!</p>\n\n<p>The <code class=\"language-plaintext highlighter-rouge\">.env</code> file only has this setting:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>BROWSER=none\n</code></pre></div></div>\n\n<p>A more important setting is in the <code class=\"language-plaintext highlighter-rouge\">.env.development</code> file (change the port to something different!):</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>PORT=3333\nHTTPS=true\n</code></pre></div></div>\n\n<p>The port number <code class=\"language-plaintext highlighter-rouge\">3333</code> and the <code class=\"language-plaintext highlighter-rouge\">https=true</code> will be important later, otherwise our setup will not work.</p>\n\n<p>Also, <strong>add</strong> this line to the <code class=\"language-plaintext highlighter-rouge\">.env</code>-file (in theory you can use any name - for this sample we keep it <code class=\"language-plaintext highlighter-rouge\">spaApp</code>):</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>PUBLIC_URL=/spaApp\n</code></pre></div></div>\n\n<p><strong>Step 4: Add the prestart to the package.json</strong></p>\n\n<p>In your project open the <code class=\"language-plaintext highlighter-rouge\">package.json</code> and <strong>add</strong> the <code class=\"language-plaintext highlighter-rouge\">prestart</code>-line like this:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  \"scripts\": {\n    \"prestart\": \"node aspnetcore-https &amp;&amp; node aspnetcore-react\",\n    \"start\": \"react-scripts start\",\n    \"build\": \"react-scripts build\",\n    \"test\": \"react-scripts test\",\n    \"eject\": \"react-scripts eject\"\n  },\n</code></pre></div></div>\n\n<p><strong>Step 5: Add the Microsoft.AspNetCore.SpaServices.Extensions NuGet package</strong></p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-01-25/aspnetreact-step5.png\" alt=\"x\" title=\"Step 5: Add the SpaServices NuGet package\" /></p>\n\n<p>We need the <a href=\"https://www.nuget.org/packages/Microsoft.AspNetCore.SpaServices.Extensions\">Microsoft.AspNetCore.SpaServices.Extensions</a> NuGet-package. If you use .NET 7, then use the version 7.x.x, if you use .NET 6, use the version 6.x.x - etc.</p>\n\n<p><strong>Step 6: Enhance your Program.cs</strong></p>\n\n<p>Add the <code class=\"language-plaintext highlighter-rouge\">SpaStaticFiles</code> to the services collection like this in your <code class=\"language-plaintext highlighter-rouge\">Program.cs</code>:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>var builder = WebApplication.CreateBuilder(args);\n\n// Add services to the container.\nbuilder.Services.AddControllersWithViews();\n\n// ‚Üì Add the following lines: ‚Üì\nbuilder.Services.AddSpaStaticFiles(configuration =&gt; {\n    configuration.RootPath = \"clientapp/build\";\n});\n// ‚Üë these lines ‚Üë\n\nvar app = builder.Build();\n</code></pre></div></div>\n\n<p>Now we need to use the SpaServices like this:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>app.MapControllerRoute(\n    name: \"default\",\n    pattern: \"{controller=Home}/{action=Index}/{id?}\");\n\n// ‚Üì Add the following lines: ‚Üì\nvar spaPath = \"/spaApp\";\nif (app.Environment.IsDevelopment())\n{\n    app.MapWhen(y =&gt; y.Request.Path.StartsWithSegments(spaPath), client =&gt;\n    {\n        client.UseSpa(spa =&gt;\n        {\n            spa.UseProxyToSpaDevelopmentServer(\"https://localhost:3333\");\n        });\n    });\n}\nelse\n{\n    app.Map(new PathString(spaPath), client =&gt;\n    {\n        client.UseSpaStaticFiles();\n        client.UseSpa(spa =&gt; {\n            spa.Options.SourcePath = \"clientapp\";\n\n            // adds no-store header to index page to prevent deployment issues (prevent linking to old .js files)\n            // .js and other static resources are still cached by the browser\n            spa.Options.DefaultPageStaticFileOptions = new StaticFileOptions\n            {\n                OnPrepareResponse = ctx =&gt;\n                {\n                    ResponseHeaders headers = ctx.Context.Response.GetTypedHeaders();\n                    headers.CacheControl = new CacheControlHeaderValue\n                    {\n                        NoCache = true,\n                        NoStore = true,\n                        MustRevalidate = true\n                    };\n                }\n            };\n        });\n    });\n}\n// ‚Üë these lines ‚Üë\n\napp.Run();\n</code></pre></div></div>\n\n<p>As you can see, we run in two different modes. \nIn our development world we just use the <code class=\"language-plaintext highlighter-rouge\">UseProxyToSpaDevelopmentServer</code>-method to proxy all requests that points to <code class=\"language-plaintext highlighter-rouge\">spaApp</code> to the React WebPack DevServer (or something else). The huge benefit is, that you can use the React ecosystem with all its tools. Normally we use Visual Studio Code to run our react frontend and use the ASP.NET Core app as the ‚ÄúBackend for frontend‚Äù.\nIn production we use the build artefacts of the react build and make sure, that it‚Äôs not cached. To make the deployment easier, we need to invoke <code class=\"language-plaintext highlighter-rouge\">npm run build</code> when we publish this ASP.NET Core app.</p>\n\n<p><strong>Step 7: Invoke npm run build during publish</strong></p>\n\n<p>Add this to your <code class=\"language-plaintext highlighter-rouge\">.csproj</code>-file and it should work:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>\t&lt;PropertyGroup&gt;\n\t\t&lt;SpaRoot&gt;clientapp\\&lt;/SpaRoot&gt;\n\t&lt;/PropertyGroup&gt;\n\n\t&lt;Target Name=\"PublishRunWebpack\" AfterTargets=\"ComputeFilesToPublish\"&gt;\n\t\t&lt;!-- As part of publishing, ensure the JS resources are freshly built in production mode --&gt;\n\t\t&lt;Exec WorkingDirectory=\"$(SpaRoot)\" Command=\"npm install\" /&gt;\n\t\t&lt;Exec WorkingDirectory=\"$(SpaRoot)\" Command=\"npm run build\" /&gt;\n\n\t\t&lt;!-- Include the newly-built files in the publish output --&gt;\n\t\t&lt;ItemGroup&gt;\n\t\t\t&lt;DistFiles Include=\"$(SpaRoot)build\\**\" /&gt;\n\t\t\t&lt;ResolvedFileToPublish Include=\"@(DistFiles-&gt;'%(FullPath)')\" Exclude=\"@(ResolvedFileToPublish)\"&gt;\n\t\t\t\t&lt;RelativePath&gt;%(DistFiles.Identity)&lt;/RelativePath&gt; &lt;!-- Changed! --&gt;\n\t\t\t\t&lt;CopyToPublishDirectory&gt;PreserveNewest&lt;/CopyToPublishDirectory&gt;\n\t\t\t\t&lt;ExcludeFromSingleFile&gt;true&lt;/ExcludeFromSingleFile&gt;\n\t\t\t&lt;/ResolvedFileToPublish&gt;\n\t\t&lt;/ItemGroup&gt;\n\t&lt;/Target&gt;\n</code></pre></div></div>\n\n<p>Be aware that these instruction are copied from the original ASP.NET Core React template and are slightly modified, otherwise the path wouldn‚Äôt match.</p>\n\n<h1 id=\"result\">Result</h1>\n\n<p>With this setup you can add any spa app that you would like to add to your ‚Äúnormal‚Äù ASP.NET Core project.</p>\n\n<p>If everything works as expected you should be able to start the React app in Visual Studio Code like this:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-01-25/aspnetreact-result-react.png\" alt=\"x\" title=\"React App in VS Code\" /></p>\n\n<p>Be aware of the <strong>https://localhost:3333/spaApp</strong>. The port and the name is important for our sample!</p>\n\n<p>Start your hosting ASP.NET Core app in Visual Studio (or in any IDE that you like) and all requests that points to <code class=\"language-plaintext highlighter-rouge\">spaApp</code> use the WebPack DevServer in the background:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-01-25/aspnetreact-result-aspnet.png\" alt=\"x\" title=\"ASPNET App in VS\" /></p>\n\n<p>With this setup you can mix all client &amp; server side styles as you like - mission succeeded and you can use any client setup (CRA, anything else) as you would like to.</p>\n\n<h1 id=\"code\">Code</h1>\n\n<p>The code (but with slightly modified values (e.g. another port)) can be found <a href=\"https://github.com/Code-Inside/Samples/tree/master/2023/aspnetreactmix\">here</a>. \nBe aware, that <code class=\"language-plaintext highlighter-rouge\">npm i</code> needs to be run first.</p>\n\n<h1 id=\"video\">Video</h1>\n\n<p>I uploaded a video on my YouTube channel (in German) about this setup:</p>\n\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/IgW79wxMO-c\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" allowfullscreen=\"\"></iframe>\n\n<p>Hope this helps!</p>\n","Href":"https://blog.codeinside.eu/2023/01/25/aspnet-core-and-react/","RawContent":null,"Thumbnail":null},{"Title":"Your URL is flagged as malware/phishing, now what?","PublishedOn":"2023-01-04T22:15:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<h1 id=\"problem\">Problem</h1>\n\n<p>On my last day in 2022 - Friday, 23. December, I received a support ticket from one customer, that our software seems to be offline and it looks like that our servers are not responding. I checked our monitoring and the server side of the customer and everything was fine. \nMy first thought: Maybe a misconfiguration on the customer side, but after a remote support session with the customer, I saw that it ‚Äúshould work‚Äù, but something in the customer network blocks the requests to our services.\nNext thought: Firewall or proxy stuff. Always nasty, but we are just using port 443, so nothing too special.</p>\n\n<p>After a while I received a phone call from the customers firewall team and they discovered the problem: They are using a firewall solution from ‚ÄúCheck Point‚Äù and <strong>our domain was flagged as ‚Äúphishing‚Äù/‚Äùmalware‚Äù</strong>. What the‚Ä¶ \nThey even created an exception so that Check Point doesn‚Äôt block our requests, but the next problem occured: The customers ‚ÄúWindows Defender for Office 365‚Äù has the same ‚Äúflag‚Äù for our domain, so they revert everything, because they didn‚Äôt want to change their settings too much.</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-01-04/defender-warning.png\" alt=\"x\" title=\"Defender Warning\" /></p>\n\n<p>Be aware, that from our end everything was working ‚Äúfine‚Äù and I could access the customer services and our Windows Defender didn‚Äôt had any problems with this domain.</p>\n\n<h1 id=\"solution\">Solution</h1>\n\n<p>Somehow our domain was flagged as malware/phishing and we needed to change this false positive listening. I guess there are tons of services, that ‚Äútracks‚Äù ‚Äúbad‚Äù websites and maybe all are connected somehow. From this indicent I can only suggest:</p>\n\n<p><strong>If you have trouble with Check Point:</strong></p>\n\n<p>Go to <a href=\"https://urlcat.checkpoint.com/urlcat/main.htm\">‚ÄúURLCAT‚Äù</a>, register an account and try to change the category of your domain. After you submit the ‚Äúchange request‚Äù you will get an email like this:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>Thank you for submitting your category change request.\nWe will process your request and notify you by email (to: xxx.xxx@xxx.com ).\nYou can follow the status of your request on this page.\nYour request details\nReference ID: [GUID]\nURL: https://[domain].com\nSuggested Categories: Computers / Internet,Business / Economy\nComment: [Given comment]\n</code></pre></div></div>\n\n<p>After ~1-2 days the change was done. Not sure if this is automated or not, but it was during Christmas.</p>\n\n<p><strong>If you have trouble with Windows Defender:</strong></p>\n\n<p>Go to <a href=\"https://security.microsoft.com/reportsubmission\">‚ÄúReport submission‚Äù</a> in your Microsoft 365 Defender setting (you will need an account with special permissions, e.g. global admin) and add the URL as ‚ÄúNot junk‚Äù.</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2023-01-04/defender-report.png\" alt=\"x\" title=\"Defender Report\" /></p>\n\n<p>I‚Äôm not really sure if this helped or not, because we didn‚Äôt had any issues with the domain itself and I‚Äôm not sure if those ‚Äúfalse positive‚Äù tickets bubbles up into a ‚Äúglobal defender catalog‚Äù or if this only affects our own tenant.</p>\n\n<h1 id=\"result\">Result</h1>\n\n<p>Anyway - after those tickets were ‚Äúresolved‚Äù by Check Point / Microsoft the problem on the customer side disappeared and everyone was happy. This was my first experience with such an ‚Äúfalse positive malware report‚Äù. I‚Äôm not sure how we ended up on such a list and why only one customer was affected.</p>\n\n<p>Hope this helps!</p>\n","Href":"https://blog.codeinside.eu/2023/01/04/checkpoint-and-defender-false-positive-url/","RawContent":null,"Thumbnail":null},{"Title":"SQLLocalDb update","PublishedOn":"2022-12-03T22:15:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<h1 id=\"short-intro\">Short Intro</h1>\n\n<p>SqlLocalDb is a ‚Äúdeveloper‚Äù SQL server, without the ‚Äúfull‚Äù SQL Server (Express) installation. If you just develop on your machine and don‚Äôt want to run a ‚Äúfull blown‚Äù SQL Server, this is the tooling that you might need.</p>\n\n<p>From the <a href=\"https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/sql-server-express-localdb?view=sql-server-ver16\">Microsoft Docs</a>:</p>\n\n<blockquote>\n  <p>Microsoft SQL Server Express LocalDB is a feature of SQL Server Express targeted to developers. It is available on SQL Server Express with Advanced Services.</p>\n\n  <p>LocalDB installation copies a minimal set of files necessary to start the SQL Server Database Engine. Once LocalDB is installed, you can initiate a connection using a special connection string. When connecting, the necessary SQL Server infrastructure is automatically created and started, enabling the application to use the database without complex configuration tasks. Developer Tools can provide developers with a SQL Server Database Engine that lets them write and test Transact-SQL code without having to manage a full server instance of SQL Server.</p>\n</blockquote>\n\n<h1 id=\"problem\">Problem</h1>\n\n<p>(I‚Äôm not really sure, how I ended up on this problem, but I after I solved the problem I did it on my ‚ÄúTo Blog‚Äù-bucket list)</p>\n\n<p>From time to time there is a new SQLLocalDb version, but to upgrade an <strong>existing</strong> installation is a bit ‚Äúweird‚Äù.</p>\n\n<h1 id=\"solution\">Solution</h1>\n\n<p>If you have installed an older SQLLocalDb version you can manage it via <code class=\"language-plaintext highlighter-rouge\">sqllocaldb</code>. If you want to update you must delete the ‚Äúcurrent‚Äù MSSQLLocalDB in the first place.</p>\n\n<p>To to this use:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>sqllocaldb stop MSSQLLocalDB\nsqllocaldb delete MSSQLLocalDB\n</code></pre></div></div>\n\n<p>Then download the newest version <a href=\"https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/sql-server-express-localdb?view=sql-server-ver16#installation-media\">from Microsoft</a>. \nIf you choose ‚ÄúDownload Media‚Äù you should see something like this:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2022-12-03/sqllocaldbinstall.png\" alt=\"x\" title=\"SQL LocalDb installer\" /></p>\n\n<p>Download it, run it and restart your PC, after that you should be able to connect to the SQLLocalDb.</p>\n\n<p>We solved this issue with help of <a href=\"https://knowledge-base.havit.eu/2020/12/17/sql-localdb-upgrade-to-2019-15-0-2000/\">this blogpost</a>.</p>\n\n<p>Hope this helps! (and I can remove it now from my bucket list \\o/ )</p>\n","Href":"https://blog.codeinside.eu/2022/12/03/sqllocaldb-update/","RawContent":null,"Thumbnail":null},{"Title":"Azure DevOps & Azure Service Connection","PublishedOn":"2022-10-04T23:15:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<p>Today I needed to setup a new release pipeline on our Azure DevOps Server installation to deploy some stuff automatically to Azure. The UI (at least on the Azure DevOps Server 2020 (!)) is not really clear about how to connect those two worlds, and thats why I‚Äôm writing this short blogpost.</p>\n\n<p>First - under project settings - add a new <strong>service connection</strong>. Use the <code class=\"language-plaintext highlighter-rouge\">Azure Resource Manager</code>-service. Now you should see something like this:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2022-10-04/azure-connection.png\" alt=\"x\" title=\"Azure Resource Manager\" /></p>\n\n<p><strong>Be aware:</strong> You will need to register app inside your Azure AD and need permissions to setup. If you are not able to follow these instructions, you might need to talk to your Azure subscription owner.</p>\n\n<p><strong>Subscription id:</strong></p>\n\n<p>Copy here the id of your subscription. This can be found in the subscription details:</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2022-10-04/subscription.png\" alt=\"x\" title=\"Azure Subscription\" /></p>\n\n<p>Keep this tab open, because we need it later!</p>\n\n<p><strong>Service prinipal id/key &amp; tenant id:</strong></p>\n\n<p>Now this wording about ‚ÄúService principal‚Äù is technically correct, but really confusing if your are not familar with Azure AD. A ‚ÄúService prinipal‚Äù is like a ‚Äúservice user‚Äù/‚Äùapp‚Äù that you need to register to use it.\nThe easiest route is to create an app via the <strong>Bash Azure CLI</strong>:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>az ad sp create-for-rbac --name DevOpsPipeline\n</code></pre></div></div>\n\n<p>If this command succeeds you should see something like this:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>{\n  \"appId\": \"[...GUID..]\",\n  \"displayName\": \"DevOpsPipeline\",\n  \"password\": \"[...PASSWORD...]\",\n  \"tenant\": \"[...Tenant GUID...]\"\n}\n</code></pre></div></div>\n\n<p>This creates an ‚ÄúSerivce principal‚Äù with a random password inside your Azure AD. The next step is to give this ‚ÄúService principal‚Äù a role on your subscription, because it has currently no permissions to do anything (e.g. deploy a service etc.).</p>\n\n<p>Go to the subscription details page and then to <strong>Access control (IAM)</strong>. There you can add your ‚ÄúDevOpsPipeline‚Äù-App as ‚ÄúContributor‚Äù (Be aware that this is a ‚Äúpowerful role‚Äù!).</p>\n\n<p>After that use the <code class=\"language-plaintext highlighter-rouge\">\"appId\": \"[...GUID..]\"</code> from the command as <strong>Service Principal Id</strong>. \nUse the <code class=\"language-plaintext highlighter-rouge\">\"password\": \"[...PASSWORD...]\"</code> as <strong>Service principal key</strong> and the <code class=\"language-plaintext highlighter-rouge\">\"tenant\": \"[...Tenant GUID...]\"</code> for the <strong>tenant id</strong>.</p>\n\n<p>Now you should be able to ‚ÄúVerify‚Äù this connection and it should work.</p>\n\n<p><strong>Links:</strong>\n<a href=\"https://azuredevopslabs.com/labs/devopsserver/azureserviceprincipal/#task-2-creating-an-azure-service-principal\">This blogpost</a> helped me a lot. <a href=\"https://learn.microsoft.com/en-us/azure/active-directory/develop/howto-create-service-principal-portal\">Here</a> you can find the official documentation.</p>\n\n<p>Hope this helps!</p>\n","Href":"https://blog.codeinside.eu/2022/10/04/azure-devops-azure-service-connection/","RawContent":null,"Thumbnail":null},{"Title":"'error MSB8011: Failed to register output.' & UTF8-BOM files","PublishedOn":"2022-08-30T23:15:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<p>Be aware: I‚Äôm not a C++ developer and this might be an ‚Äúobvious‚Äù problem, but it took me a while to resolve this issue.</p>\n\n<p>In our product we have very few C++ projects. We use these projects for very special Microsoft Office COM stuff and because of COM we need to register some components during the build. Everything worked as expected, but we renamed a few files and our build broke with:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>C:\\Program Files\\Microsoft Visual Studio\\2022\\Enterprise\\MSBuild\\Microsoft\\VC\\v170\\Microsoft.CppCommon.targets(2302,5): warning MSB3075: The command \"regsvr32 /s \"C:/BuildAgentV3_1/_work/67/s\\_Artifacts\\_ReleaseParts\\XXX.Client.Addin.x64-Shims\\Common\\XXX.Common.Shim.dll\"\" exited with code 5. Please verify that you have sufficient rights to run this command. [C:\\BuildAgentV3_1\\_work\\67\\s\\XXX.Common.Shim\\XXX.Common.Shim.vcxproj]\nC:\\Program Files\\Microsoft Visual Studio\\2022\\Enterprise\\MSBuild\\Microsoft\\VC\\v170\\Microsoft.CppCommon.targets(2314,5): error MSB8011: Failed to register output. Please try enabling Per-user Redirection or register the component from a command prompt with elevated permissions. [C:\\BuildAgentV3_1\\_work\\67\\s\\XXX.Common.Shim\\XXX.Common.Shim.vcxproj]\n\n(xxx = redacted)\n</code></pre></div></div>\n\n<p>The crazy part was: Using an older version of our project just worked as expected, but all changes were ‚Äúfine‚Äù from my point of view.</p>\n\n<p>After many, many attempts I remembered that our diff tool doesn‚Äôt show us everything - so I checked the <strong>file encodings</strong>: <code class=\"language-plaintext highlighter-rouge\">UTF8-BOM</code></p>\n\n<p>Somehow if you have a UTF8-BOM encoded file that your C++ project uses to register COM stuff it will fail. I changed the encoding and to <code class=\"language-plaintext highlighter-rouge\">UTF8</code> and everyting worked as expected.</p>\n\n<p>What a day‚Ä¶ lessons learned: Be aware of your file encodings.</p>\n\n<p>Hope this helps!</p>\n","Href":"https://blog.codeinside.eu/2022/08/30/error-msb8011-failed-to-register-output-and-utf8bom/","RawContent":null,"Thumbnail":null},{"Title":"Which .NET Framework Version is installed on my machine?","PublishedOn":"2022-08-29T23:15:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<p>If you need to know which .NET Framework Version (the ‚Äúlegacy‚Äù .NET Framework) is installed on your machine try this handy oneliner:</p>\n\n<div class=\"language-ps highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nf\">Get-ItemProperty</span> <span class=\"nf\">\"HKLM:SOFTWARE\\Microsoft\\NET</span> <span class=\"nf\">Framework</span> <span class=\"nf\">Setup\\NDP\\v4\\Full\"</span>\n</code></pre></div></div>\n\n<p>Result:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>CBS           : 1\nInstall       : 1\nInstallPath   : C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\\nRelease       : 528372\nServicing     : 0\nTargetVersion : 4.0.0\nVersion       : 4.8.04084\nPSPath        : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\NET Framework\n                Setup\\NDP\\v4\\Full\nPSParentPath  : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\NET Framework Setup\\NDP\\v4\nPSChildName   : Full\nPSDrive       : HKLM\nPSProvider    : Microsoft.PowerShell.Core\\Registry\n</code></pre></div></div>\n\n<p>The <strong>version</strong> should give you more then enough information.</p>\n\n<p>Hope this helps!</p>\n","Href":"https://blog.codeinside.eu/2022/08/29/which-dotnet-version-is-installed-via-powershell/","RawContent":null,"Thumbnail":null},{"Title":"How to run a Azure App Service WebJob with parameters","PublishedOn":"2022-07-22T23:45:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<p>We are using <strong><a href=\"https://docs.microsoft.com/en-us/azure/app-service/webjobs-create\">WebJobs</a></strong> in our Azure App Service deployment and they are pretty ‚Äúeasy‚Äù for the most part. Just register a WebJobs or deploy your <code class=\"language-plaintext highlighter-rouge\">.exe/.bat/.ps1/...</code> under the <code class=\"language-plaintext highlighter-rouge\">\\site\\wwwroot\\app_data\\Jobs\\triggered</code> folder and it should execute as described in the <code class=\"language-plaintext highlighter-rouge\">settings.job</code>.</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2022-07-20/portal.png\" alt=\"x\" title=\"Portal\" /></p>\n\n<p>If you put any executable in this WebJob folder, it will be executed as planned.</p>\n\n<p><strong>Problem: Parameters</strong></p>\n\n<p>If you have a <code class=\"language-plaintext highlighter-rouge\">my-job.exe</code>, then this will be invoked from the runtime. But what if you need to invoke it with a parameter like <code class=\"language-plaintext highlighter-rouge\">my-job.exe -param \"test\"</code>?</p>\n\n<p><strong>Solution: run.cmd</strong></p>\n\n<p>The WebJob environment is ‚Äúgreedy‚Äù and will search for a <code class=\"language-plaintext highlighter-rouge\">run.cmd</code> (or <code class=\"language-plaintext highlighter-rouge\">run.exe</code>) and if this is found, it will be executed and it doesn‚Äôt matter if you have any other <code class=\"language-plaintext highlighter-rouge\">.exe</code> files there.\nStick to the <code class=\"language-plaintext highlighter-rouge\">run.cmd</code> and use this to invoke your actual executable like this:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>echo \"Invoke my-job.exe with parameters - Start\"\n\n..\\MyJob\\my-job.exe -param \"test\"\n\necho \"Invoke my-job.exe with parameters - Done\"\n</code></pre></div></div>\n\n<p>Be aware, that the path must ‚Äúmatch‚Äù. We use this <code class=\"language-plaintext highlighter-rouge\">run.cmd</code>-approach in combination with the <code class=\"language-plaintext highlighter-rouge\">is_in_place</code>-option (see <a href=\"https://github.com/projectkudu/kudu/wiki/WebJobs#webjob-working-directory\">here</a>) and are happy with the results).</p>\n\n<p>A more detailed explanation can be found <a href=\"https://github.com/projectkudu/kudu/wiki/WebJobs\">here</a>.</p>\n\n<p>Hope this helps!</p>\n","Href":"https://blog.codeinside.eu/2022/07/22/how-to-run-a-azure-appservice-webjob-with-parameters/","RawContent":null,"Thumbnail":null},{"Title":"How to use IE proxy settings with HttpClient","PublishedOn":"2022-03-28T23:45:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<p>Internet Explorer is - mostly - dead, but some weird settings are still around and ‚Äúattached‚Äù to the old world, at least on Windows 10. \nIf your system administrator uses some advanced proxy settings (e.g. a <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Proxy_servers_and_tunneling/Proxy_Auto-Configuration_PAC_file\">PAC-file</a>), those will be attached to the users IE setting.</p>\n\n<p>If you want to use this with a HttpClient you need to code something like this:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>    string target = \"https://my-target.local\";\n    var targetUri = new Uri(target);\n    var proxyAddressForThisUri = WebRequest.GetSystemWebProxy().GetProxy(targetUri);\n    if (proxyAddressForThisUri == targetUri)\n    {\n        // no proxy needed in this case\n        _httpClient = new HttpClient();\n    }\n    else\n    {\n        // proxy needed\n        _httpClient = new HttpClient(new HttpClientHandler() { Proxy = new WebProxy(proxyAddressForThisUri) { UseDefaultCredentials = true } });\n    }\n</code></pre></div></div>\n\n<p>The <a href=\"https://docs.microsoft.com/de-de/dotnet/api/system.net.webrequest.getsystemwebproxy?view=net-6.0\">GetSystemWebProxy()</a> gives access to the system proxy settings from the current user. Then we can query, what proxy is needed for the target. If the result is the same address as the target, then no proxy is needed. Otherwise, we inject a new WebProxy for this address.</p>\n\n<p>Hope this helps!</p>\n\n<p><strong>Be aware:</strong> Creating new HttpClients is (at least in a server environment) not recommended. Try to reuse the same HttpClient instance!</p>\n\n<p>Also note: The proxy setting in Windows 11 are now built into the system settings, but the API still works :)</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2022-03-28/windows11.png\" alt=\"x\" title=\"Windows 11\" /></p>\n","Href":"https://blog.codeinside.eu/2022/03/28/how-to-use-ie-proxy-settings-with-httpclient/","RawContent":null,"Thumbnail":null},{"Title":"Redirect to HTTPS with a simple web.config rule","PublishedOn":"2022-01-05T23:45:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<p>The scenario is easy: My website is hosted in an IIS and would like to redirect all incomming HTTP traffic to the HTTPS counterpart.</p>\n\n<p>This is your solution - a ‚Äúsimple‚Äù rule:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;configuration&gt;\n    &lt;system.webServer&gt;\n        &lt;rewrite&gt;\n            &lt;rules&gt;\n                &lt;rule name=\"Redirect to https\" stopProcessing=\"true\"&gt;\n                    &lt;match url=\".*\" /&gt;\n                    &lt;conditions logicalGrouping=\"MatchAny\"&gt;\n                        &lt;add input=\"{HTTPS}\" pattern=\"off\" /&gt;\n                    &lt;/conditions&gt;\n                    &lt;action type=\"Redirect\" url=\"https://{HTTP_HOST}{REQUEST_URI}\" redirectType=\"Found\" /&gt;\n                &lt;/rule&gt;\n            &lt;/rules&gt;\n        &lt;/rewrite&gt;\n    &lt;/system.webServer&gt;\n&lt;/configuration&gt;\n</code></pre></div></div>\n\n<p>We used this in the past to setup a ‚Äúcatch all‚Äù web site in an IIS that redirects all incomming HTTP traffic.\nThe actual web applications had only the HTTPS binding in place.</p>\n\n<p>Hope this helps!</p>\n","Href":"https://blog.codeinside.eu/2022/01/05/redirect-to-https-with-a-simple-webconfig-rule/","RawContent":null,"Thumbnail":null},{"Title":"Select random rows","PublishedOn":"2021-12-06T23:45:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<p>Let‚Äôs say we have a SQL table and want to retrieve 10 rows randomly - how would you do that? Although I have been working with SQL for x years, I have never encountered that problem. The solution however is quite ‚Äúsimple‚Äù (at least if you don‚Äôt be picky how we define ‚Äúrandomness‚Äù and if you try this on millions of rows):</p>\n\n<h2 id=\"order-by-newid\">ORDER BY NEWID()</h2>\n\n<p>The most boring way is to use the <code class=\"language-plaintext highlighter-rouge\">ORDER BY NEWID()</code> clause:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>SELECT TOP 10 FROM Products ORDER BY NEWID()\n</code></pre></div></div>\n\n<p>This works, but if you do that on ‚Äúlarge‚Äù datasets you might hit performance problems (e.g. more on that <a href=\"https://docs.microsoft.com/en-us/previous-versions/software-testing/cc441928(v=msdn.10)?redirectedfrom=MSDN\">here</a>)</p>\n\n<h2 id=\"tablesampe\">TABLESAMPE</h2>\n\n<p>The SQL Server implements the <code class=\"language-plaintext highlighter-rouge\">Tablesample clause</code> which was new to me. It seems to perform much bettern then the <code class=\"language-plaintext highlighter-rouge\">ORDER BY NEWID()</code> clause, but behaves a bit weird. With this clause you can specify the ‚Äúsample‚Äù from a table. The size of the sample can be specified as <code class=\"language-plaintext highlighter-rouge\">PERCENT</code> or <code class=\"language-plaintext highlighter-rouge\">ROWS</code> (which are then converted to percent internally).</p>\n\n<p>Syntax:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>SELECT TOP 10 FROM Products TABLESAMPLE (25 Percent)\nSELECT TOP 10 FROM Products TABLESAMPLE (100 ROWS)\n</code></pre></div></div>\n\n<p>The weird part is that the given number might not match the number of rows of your result. You might got more or less results and if our tablesample is too small you might even got nothing in return. There are some clever ways to work around this (e.g. using the <code class=\"language-plaintext highlighter-rouge\">TOP 100</code> statement with a much larger tablesample clause to get a guaranteed result set), but it feels ‚Äústrange‚Äù.\nIf you hit limitations with the first solution you might want to read more on <a href=\"https://www.mssqltips.com/sqlservertip/1308/retrieving-random-data-from-sql-server-with-tablesample/\">this blog</a> or in the <a href=\"https://docs.microsoft.com/en-us/sql/t-sql/queries/from-transact-sql?view=sql-server-ver15#tablesample-clause\">Microsoft Docs</a>.</p>\n\n<h2 id=\"stackoverflow\">Stackoverflow</h2>\n\n<p>Of course there is a great <a href=\"https://stackoverflow.com/questions/848872/select-n-random-rows-from-sql-server-table\">Stackoverflow thread</a> with even wilder solutions.</p>\n\n<p>Hope this helps!</p>\n","Href":"https://blog.codeinside.eu/2021/12/06/select-random-rows/","RawContent":null,"Thumbnail":null},{"Title":"SQL collation problems","PublishedOn":"2021-11-24T23:45:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<p>This week I deployed a new feature and tried it on different SQL databases and was a bit suprised that on one database this error message came up:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>Cannot resolve the collation conflict between \"Latin1_General_CI_AS\" and \"SQL_Latin1_General_CP1_CI_AS\" in the equal to operation.\n</code></pre></div></div>\n\n<p>This was strange, because - at least in theory - all databases have the same schema and I was sure that each database had the same collation setting.</p>\n\n<h2 id=\"collations-on-columns\">Collations on columns</h2>\n\n<p>Well‚Ä¶ my theory was wrong and this SQL statement told me that ‚Äúsome‚Äù columns had a different collation.</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>select sc.name, sc.collation_name from sys.columns sc\ninner join sys.tables t on sc.object_id=t.object_id\nwhere t.name='TABLENAME'\n</code></pre></div></div>\n\n<p>As it turns out, some columns had the collation <code class=\"language-plaintext highlighter-rouge\">Latin1_General_CI_AS</code> and some had <code class=\"language-plaintext highlighter-rouge\">SQL_Latin1_General_CP1_CI_AS</code>. I‚Äôm still not sure why, but I needed to do something.</p>\n\n<h2 id=\"how-to-change-the-collation\">How to change the collation</h2>\n\n<p>To change the collation you can execute something like this:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>ALTER TABLE MyTable\nALTER COLUMN [MyColumn] NVARCHAR(200) COLLATE SQL_Latin1_General_CP1_CI_AS\n</code></pre></div></div>\n\n<p>Unfortunately there are restrictions and you can‚Äôt change the collation if the column is referenced by any one of the following:</p>\n\n<ul>\n  <li>A computed column</li>\n  <li>An index</li>\n  <li>Distribution statistics, either generated automatically or by the CREATE STATISTICS statement</li>\n  <li>A CHECK constraint</li>\n  <li>A FOREIGN KEY constraint</li>\n</ul>\n\n<p><strong>Be aware:</strong> If you are not in control of the collation or if the collation is ‚Äúfine‚Äù and you want to do this operation anyway, there might be a way to specify the collation in the SQL query.</p>\n\n<p>For more information you might want to check out this Microsoft Docs ‚Äú<a href=\"https://docs.microsoft.com/en-us/sql/relational-databases/collations/set-or-change-the-column-collation?view=sql-server-ver15\">Set or Change the Column Collation</a>‚Äù</p>\n\n<p>Hope this helps!</p>\n","Href":"https://blog.codeinside.eu/2021/11/24/sql-collations-problem/","RawContent":null,"Thumbnail":null},{"Title":"Microsoft Build 2021 session recommendations","PublishedOn":"2021-09-24T23:45:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<p>To be fair: <a href=\"https://www.youtube.com/playlist?list=PLlrxD0HtieHgMGEnTzEEfkADbaG8aAWRp\">Microsoft Build 2021</a> was some month ago, but the content might still be relevant today. Sooo‚Ä¶ it took me a while, but here is a list of sessions that I found interesting. Some sessions are ‚Äúbetter‚Äù and some ‚Äúlighter‚Äù, the order doesn‚Äôt reflect that - that was just the order I watched those videos.</p>\n\n<p>The headline has a link to the video and below are some notes.</p>\n\n<h2 id=\"build-cloud-native-applications-that-run-anywhere\"><a href=\"https://mybuild.microsoft.com/sessions/2debfc2e-f0b3-4adf-bcec-d126930f806f?source=sessions\">Build cloud-native applications that run anywhere</a></h2>\n\n<ul>\n  <li>Azure Arc (GitHub &amp; Policies)</li>\n  <li>AKS</li>\n</ul>\n\n<h2 id=\"build-differentiated-saas-apps-with-the-microsoft-cloud\"><a href=\"https://mybuild.microsoft.com/sessions/3a820fb4-a38f-4bf8-b731-4411ed559807?source=sessions\">Build differentiated SaaS apps with the Microsoft Cloud</a></h2>\n\n<ul>\n  <li>Power Apps</li>\n  <li>‚ÄúLight‚Äù session - only if you are interested in Microsofts ‚ÄúLow Code‚Äù portfolio</li>\n</ul>\n\n<h2 id=\"build-the-next-generation-of-collaborative-apps-for-hybrid-work\">[Build the next generation of collaborative apps for hybrid work</h2>\n<p>](https://mybuild.microsoft.com/sessions/2915b9b6-6b45-430a-9df7-2671318e2161?source=sessions)</p>\n\n<ul>\n  <li>Overview Dev Platform (PowerApps, Graph‚Ä¶)</li>\n  <li>Fluid</li>\n  <li>Adaptive Cards</li>\n  <li>Project.Reunion / WebView 2</li>\n</ul>\n\n<h2 id=\"mark-russinovich-on-azure-innovation-and-more\">[Mark Russinovich on Azure innovation and more!</h2>\n<p>](https://mybuild.microsoft.com/sessions/b7d536c1-515f-476a-83d2-85b6cf14577a?source=sessions)</p>\n\n<ul>\n  <li>Dapr</li>\n  <li>Story about RdcMan</li>\n  <li>Sysmon on linux</li>\n</ul>\n\n<h2 id=\"learn-how-to-build-exciting-apps-across-meetings-chats-and-channels-within-or-outside-microsoft-teams\">[Learn how to build exciting apps across meetings, chats, and channels within or outside Microsoft Teams](</h2>\n<p>https://mybuild.microsoft.com/sessions/512470be-15d3-4b50-b180-6532c8153931?source=sessions)</p>\n\n<ul>\n  <li>Microsoft Teams SDK</li>\n  <li>Azure Communication Services</li>\n  <li>Meeting Events, Media APIs, Share integration</li>\n  <li>Teams Connect</li>\n  <li>Adaptive Cards in Teams</li>\n  <li>Messaging Extensions in Outlook for Web</li>\n  <li>Together Mode scenes</li>\n</ul>\n\n<h2 id=\"whats-new-for-windows-desktop-application-development\"><a href=\"https://mybuild.microsoft.com/sessions/79b87707-0505-4144-aab9-94cc30f91340?source=sessions\">What‚Äôs new for Windows desktop application development</a></h2>\n\n<ul>\n  <li>Project Reunion</li>\n  <li>MAUI</li>\n</ul>\n\n<h2 id=\"understand-the-ml-process-and-embed-models-into-apps\">[Understand the ML process and embed models into apps</h2>\n<p>](https://mybuild.microsoft.com/sessions/10930f2e-ad9c-460b-b91d-844d17a5a875?source=sessions)</p>\n\n<ul>\n  <li>Azure ML</li>\n  <li>‚ÄúData scientist‚Äù: VS Code Demo with Jupyter Notebooks, PyTorch, TensorBoard</li>\n  <li>‚ÄúMLOps‚Äù</li>\n  <li>Azure Machine Learning Studio</li>\n  <li>‚ÄúRed/Blue‚Äù-Deployment via GitHub Actions</li>\n</ul>\n\n<h2 id=\"the-future-of-modern-application-development-with-net\">[The future of modern application development with .NET</h2>\n<p>](https://mybuild.microsoft.com/sessions/76ebac39-517d-44da-a58e-df4193b5efa9?source=sessions)</p>\n\n<ul>\n  <li>‚Äú.NET Core Momentum‚Äù</li>\n  <li>.NET Upgrade Assistant</li>\n  <li>Minimal web apis</li>\n  <li>MAUI</li>\n  <li>Blazor in Web &amp; Desktop</li>\n  <li>Hot Reload</li>\n</ul>\n\n<h2 id=\"scott-guthrie-unplugged--home-edition-extended\"><a href=\"https://mybuild.microsoft.com/sessions/71450b02-3006-4971-b4d1-80602087e10b?source=sessions\">Scott Guthrie ‚ÄòUnplugged‚Äô ‚Äì Home Edition (Extended)</a></h2>\n\n<ul>\n  <li>ScottGu</li>\n  <li>DevTools</li>\n  <li>GitHub Actions</li>\n  <li>Codespaces</li>\n  <li>Cosmos DB: Serverless, Cache, Encryption, Free tier enhancements</li>\n  <li>Azure AI</li>\n</ul>\n\n<h2 id=\"build-your-first-web-app-with-blazor--web-assembly\"><a href=\"https://mybuild.microsoft.com/sessions/d8cac5a4-6fee-4e30-aa0b-58131f2e03bc?source=sessions\">Build your first web app with Blazor &amp; Web Assembly</a></h2>\n\n<ul>\n  <li>Learning video</li>\n</ul>\n\n<h2 id=\"develop-apps-with-the-microsoft-graph-toolkit\"><a href=\"https://mybuild.microsoft.com/sessions/27dbe743-5469-453c-b165-7c7c9250a937?source=sessions\">Develop apps with the Microsoft Graph Toolkit</a></h2>\n\n<ul>\n  <li>‚ÄúLow code‚Äù Learning video about the toolkit</li>\n</ul>\n\n<h2 id=\"application-authentication-in-the-microsoft-identity-platform\"><a href=\"https://mybuild.microsoft.com/sessions/9eadeef5-96a2-4fd2-ac9a-2a83deed93df?source=sessions\">Application Authentication in the Microsoft Identity platform</a></h2>\n\n<ul>\n  <li>MSAL 2.0 &amp; Microsoft Identity Platform</li>\n  <li>SPA App with JS</li>\n  <li>WebApps stuff with ASP.NET Core</li>\n  <li>Service apps</li>\n</ul>\n\n<h2 id=\"double-click-with-microsoft-engineering-leaders\">[Double-click with Microsoft engineering leaders</h2>\n<p>](https://mybuild.microsoft.com/sessions/08538f9b-e562-4d71-8b42-d240c3966ef0?source=sessions)</p>\n\n<ul>\n  <li>‚ÄúWhiteboarding-style‚Äù</li>\n  <li>GitOps Concepts</li>\n  <li>Velocity - Inner/Outer Loop</li>\n  <li>Data Analytics with Cosmos DB</li>\n  <li>Azure Cloud ‚Äúoverview‚Äù</li>\n</ul>\n\n<h2 id=\"net-6-deep-dive-whats-new-and-whats-coming\">[.NET 6 deep dive; what‚Äôs new and what‚Äôs coming</h2>\n<p>](https://mybuild.microsoft.com/sessions/70d379f4-1173-4941-b389-8796152ec7b8?source=sessions)</p>\n\n<ul>\n  <li>.NET Momentum</li>\n  <li>.NET 5 - why</li>\n  <li>.NET 6 main features</li>\n  <li>EF Core</li>\n  <li>C# 10</li>\n  <li>Minimal WebApis</li>\n  <li>MAUI</li>\n  <li>Blazor</li>\n  <li>ASP.NET Core</li>\n  <li>Edit and Continue</li>\n</ul>\n\n<p>Hope this helps.</p>\n","Href":"https://blog.codeinside.eu/2021/09/24/build-2021-recommendation/","RawContent":null,"Thumbnail":null},{"Title":"Today I learned (sort of) 'fltmc' to inspect the IO request pipeline of Windows","PublishedOn":"2021-05-30T22:00:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<p>The headline is obviously a big lie, because I followed <a href=\"https://twitter.com/richturn_ms/status/1245836872598704128\">this twitter conversation</a> last year, but it‚Äôs still interesting to me and I wanted to write it somewhere down.</p>\n\n<p>Starting point was that <a href=\"https://twitter.com/BruceDawson0xB\">Bruce Dawson (Google programmer)</a> noticed, that building Chrome on Windows is slow for various reasons:</p>\n\n<blockquote class=\"twitter-tweet\"><p lang=\"en\" dir=\"ltr\">Based on some twitter discussion about source-file length and build times two months ago I wrote a blog post. It&#39;s got real data based on Chromium&#39;s build, and includes animations of build-time improvements:<a href=\"https://t.co/lsLH8BNe48\">https://t.co/lsLH8BNe48</a></p>&mdash; Bruce Dawson (Antifa) (@BruceDawson0xB) <a href=\"https://twitter.com/BruceDawson0xB/status/1244850501457285122?ref_src=twsrc%5Etfw\">March 31, 2020</a></blockquote>\n<script async=\"\" src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<p><a href=\"https://twitter.com/TrententTye\">Trentent Tye</a> told him to disable the ‚Äúfilter driver‚Äù:</p>\n\n<blockquote class=\"twitter-tweet\"><p lang=\"en\" dir=\"ltr\">disabling the filter driver makes it dead dead dead. Might be worth testing with the number and sizes of files you are dealing with. Even half a millisecond of processing time adds up when it runs against millions and millions of files.</p>&mdash; Trentent Tye (@TrententTye) <a href=\"https://twitter.com/TrententTye/status/1245395826907602945?ref_src=twsrc%5Etfw\">April 1, 2020</a></blockquote>\n<script async=\"\" src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<p>If you have never heard of a ‚Äúfilter driver‚Äù (like me :)), you might want to take a look <a href=\"https://docs.microsoft.com/en-us/windows-hardware/test/assessments/minifilter-diagnostics\">here</a>.</p>\n\n<p>To see the loaded filter driver on your machine try out this: Run <code class=\"language-plaintext highlighter-rouge\">fltmc</code> (<a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/ifs/development-and-testing-tools\">fltmc.exe</a>) as admin.</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2021-05-30/fltmc.png\" alt=\"x\" title=\"fltmc result\" /></p>\n\n<p>Description:</p>\n\n<blockquote class=\"twitter-tweet\" data-conversation=\"none\"><p lang=\"en\" dir=\"ltr\">Each filter in the list sit in a pipe through which all IO requests bubble down and up. They see all IO requests, but ignore most. Ever wondered how Windows offers encrypted files, OneDrive/GDrive/DB file sync, storage quotas, system file protection, and, yes, anti-malware? ;)</p>&mdash; Rich Turner (@richturn_ms) <a href=\"https://twitter.com/richturn_ms/status/1245836872598704128?ref_src=twsrc%5Etfw\">April 2, 2020</a></blockquote>\n<script async=\"\" src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<p>This makes more or less sense to me. I‚Äôm not really sure what to do with that information, but it‚Äôs cool (nerd cool, but anyway :)).</p>\n","Href":"https://blog.codeinside.eu/2021/05/30/fltmc-inspect-the-io-request-pipeline-of-windows/","RawContent":null,"Thumbnail":null},{"Title":"How to self host Google Fonts","PublishedOn":"2021-04-28T23:30:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<p><a href=\"https://fonts.google.com/\">Google Fonts</a> are really nice and widely used. Typically Google Fonts consistes of the actual font file (e.g. woff, ttf, eot etc.) and some CSS, which points to those font files.</p>\n\n<p>In one of our applications, we used a HTML/CSS/JS - Bootstrap like theme and the theme linked some Google Fonts. The problem was, that we wanted to <strong>self host everything</strong>.</p>\n\n<p>After some research we discovered this tool: <strong><a href=\"https://google-webfonts-helper.herokuapp.com/\">Google-Web-Fonts-Helper</a></strong></p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2021-04-28/image.png\" alt=\"x\" title=\"Google Web Fonts Helper\" /></p>\n\n<p>Pick your font, select your preferred CSS option (e.g. if you need to support older browsers etc.) and download a complete .zip package. Extract those files and add them to your web project like any other static asset. (<em>And check the font license!</em>)</p>\n\n<p>The project site is on <a href=\"https://github.com/majodev/google-webfonts-helper\">GitHub</a>.</p>\n\n<p>Hope this helps!</p>\n","Href":"https://blog.codeinside.eu/2021/04/28/how-to-self-host-google-fonts/","RawContent":null,"Thumbnail":null},{"Title":"Microsoft Graph: Read user profile and group memberships","PublishedOn":"2021-01-31T23:30:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<p>In our application we have a background service, that ‚Äúsyncs‚Äù user data and group membership information to our database from the <a href=\"https://docs.microsoft.com/en-us/graph\">Microsoft Graph</a>.</p>\n\n<p><strong>The permission model:</strong></p>\n\n<p>Programming against the Microsoft Graph is quite easy. There are many <a href=\"https://docs.microsoft.com/en-us/graph/sdks/sdks-overview\">SDKS</a> available, but understanding the <a href=\"https://docs.microsoft.com/en-us/graph/permissions-reference\">permission model</a> is hard.</p>\n\n<p><strong>‚ÄòDirectory.Read.All‚Äô and ‚ÄòUser.Read.All‚Äô:</strong></p>\n\n<p>Initially we only synced the ‚Äúbasic‚Äù user data to our database, but then some customers wanted to reuse some other data already stored in the graph. Our app required the ‚ÄòDirectory.Read.All‚Äô permission, because we thought that this would be the ‚Äúhighest‚Äù permission - this is <strong>wrong</strong>!</p>\n\n<p>If you need ‚Äúdirectory‚Äù information, e.g. memberships, the <code class=\"language-plaintext highlighter-rouge\">Directory.Read.All</code> or <code class=\"language-plaintext highlighter-rouge\">Group.Read.All</code> is a good starting point. But if you want to load specific user data, you might need to have the <code class=\"language-plaintext highlighter-rouge\">User.Read.All</code> permission as well.</p>\n\n<p>Hope this helps!</p>\n","Href":"https://blog.codeinside.eu/2021/01/31/microsoft-graph-read-user-profile-and-group-memberships/","RawContent":null,"Thumbnail":null},{"Title":"How to get all distribution lists of a user with a single LDAP query","PublishedOn":"2020-12-31T00:30:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<p>In 2007 I wrote a blogpost how easy it is to get all ‚Äúgroups‚Äù of a given user via the <a href=\"https://blog.codeinside.eu/2017/03/02/howto-get-user-information-and-groups-from-ad/\">tokenGroup attribute</a>.</p>\n\n<p>Last month I had the task to check why ‚Äúdistribution list memberships‚Äù are not part of the result.</p>\n\n<p><strong>The reason is simple:</strong></p>\n\n<p>A pure distribution list (<strong>not security enabled</strong>) is not a security group and only security groups are part of the ‚ÄútokenGroup‚Äù attribute.</p>\n\n<p>After some thoughts and discussions we agreed, that it would be good if we could enhance our function and treat distribution lists like security groups.</p>\n\n<h1 id=\"how-to-get-all-distribution-lists-of-a-user\">How to get all distribution lists of a user?</h1>\n\n<p>The get all groups of a given user might be seen as trivial, but the problem is, that groups can contain other groups. \nAs always, there are a couple of ways to get a ‚Äúfull flat‚Äù list of all group memberships.</p>\n\n<p>A <em>stupid</em> way would be to load all groups in a recrusive function - this might work, but will result in a flood of requests.</p>\n\n<p>A <em>clever</em> way would be to write a good LDAP query and let the Active Directory do the heavy lifting for us, right?</p>\n\n<h1 id=\"12840113556141941\">1.2.840.113556.1.4.1941</h1>\n\n<p>I found some sample code online with a very strange LDAP query and it turns out:\nThere is a ‚Äúmagic‚Äù ldap query called ‚Äú<a href=\"https://ldapwiki.com/wiki/LDAP_MATCHING_RULE_IN_CHAIN\">LDAP_MATCHING_RULE_IN_CHAIN</a>‚Äù and it does everything we are looking for:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>var getGroupsFilterForDn = $\"(&amp;(objectClass=group)(member:1.2.840.113556.1.4.1941:= {distinguishedName}))\";\n                using (var dirSearch = CreateDirectorySearcher(getGroupsFilterForDn))\n                {\n                    using (var results = dirSearch.FindAll())\n                    {\n                        foreach (SearchResult result in results)\n                        {\n                            if (result.Properties.Contains(\"name\") &amp;&amp; result.Properties.Contains(\"objectSid\") &amp;&amp; result.Properties.Contains(\"groupType\"))\n                                groups.Add(new GroupResult() { Name = (string)result.Properties[\"name\"][0], GroupType = (int)result.Properties[\"groupType\"][0], ObjectSid = new SecurityIdentifier((byte[])result.Properties[\"objectSid\"][0], 0).ToString() });\n                        }\n                    }\n                }\n</code></pre></div></div>\n\n<p>With a given distinguishedName of the target user, we can load all distribution and security groups (see below‚Ä¶) transitive!</p>\n\n<h1 id=\"combine-tokengroups-and-this\">Combine tokenGroups and this</h1>\n\n<p>During our testing we found some minor differences between the LDAP_MATCHING_RULE_IN_CHAIN and the tokenGroups approach. Some ‚Äúsystem-level‚Äù security groups were missing with the LDAP_MATCHING_RULE_IN_CHAIN way. In our production code we use a combination of those two approaches and it seems to work.</p>\n\n<p>A full demo code how to get all distribution lists for a user can be found on <a href=\"https://github.com/Code-Inside/Samples/tree/master/2020/Distributionlists\">GitHub</a>.</p>\n\n<p>Hope this helps!</p>\n","Href":"https://blog.codeinside.eu/2020/12/31/how-get-all-distribution-lists-of-a-user-with-a-single-ldap-query/","RawContent":null,"Thumbnail":null},{"Title":"Update AzureDevOps Server 2019 to AzureDevOps Server 2019 Update 1","PublishedOn":"2020-11-30T18:00:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<p><em>We did this update in May 2020, but I forgot to publish the blogpost‚Ä¶ so here we are</em></p>\n\n<p>Last year we updated to <a href=\"https://blog.codeinside.eu/2019/04/30/update-onprem-tfs-2018-to-azuredevops-server-2019/\">Azure DevOps Server 2019</a> and it went more or less smooth.</p>\n\n<p>In May we decided to update to the ‚Äúnewest‚Äù release at that time: <a href=\"https://docs.microsoft.com/en-us/azure/devops/server/release-notes/azuredevops2019u1?view=azure-devops\">Azure DevOps Server 2019 Update 1.1</a></p>\n\n<h1 id=\"setup\">Setup</h1>\n\n<p>Our AzureDevOps Server was running on a ‚Äúnew‚Äù Windows Server 2019 and everything was still kind of newish - so we just needed to update the AzureDevOps Server app.</p>\n\n<h1 id=\"update-process\">Update process</h1>\n\n<p>The actual update was really easy, but we had some issues after the installation.</p>\n\n<h2 id=\"steps\">Steps:</h2>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2020-11-30/AzureDevOps.png\" alt=\"x\" title=\"Step 1\" /></p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2020-11-30/AzureDevOps1.png\" alt=\"x\" title=\"Step 2\" /></p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2020-11-30/AzureDevOps2.png\" alt=\"x\" title=\"Step 3\" /></p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2020-11-30/AzureDevOps3.png\" alt=\"x\" title=\"Step 4\" /></p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2020-11-30/AzureDevOps4.png\" alt=\"x\" title=\"Step 5\" /></p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2020-11-30/AzureDevOps5.png\" alt=\"x\" title=\"Final\" /></p>\n\n<h2 id=\"aftermath\">Aftermath</h2>\n\n<p>We had some issues with our Build Agents - they couldn‚Äôt connect to the AzureDevOps Server:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>TF400813: Resource not available for anonymous access\n</code></pre></div></div>\n\n<p>As a first ‚Äúworkaround‚Äù (and a nice enhancement) we switched from <strong>HTTP</strong> to <strong>HTTPS</strong> internally, but this didn‚Äôt solved the problem.</p>\n\n<p>The real reason was, that our ‚ÄúAzure DevOps Service User‚Äù didn‚Äôt had the required write permissions for this folder:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>C:\\ProgramData\\Microsoft\\Crypto\\RSA\\MachineKeys\n</code></pre></div></div>\n\n<p>The connection issue went away, but now we introduced another problem: Our SSL Certificate was ‚Äúself signed‚Äù (from our Domain Controller), so we need to register the agents like this:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>.\\config.cmd --gituseschannel --url https://.../tfs/ --auth Integrated --pool Default-VS2019 --replace --work _work\n</code></pre></div></div>\n\n<p>The important parameter is <strong>-gituseschannel</strong>, which is needed when dealing with ‚Äúself signed, but Domain ‚Äòtrusted‚Äô‚Äú-certificates.</p>\n\n<p>With this setting everything seemed to work as expected.</p>\n\n<p>Only node.js projects or toolings were ‚Äúproblematic‚Äù, because node.js itself don‚Äôt use the Windows Certificate Store.</p>\n\n<p>To resolve this, the <strong>root certificate</strong> from our Domain controller must be stored on the agent.</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  [Environment]::SetEnvironmentVariable(\"NODE_EXTRA_CA_CERTS\", \"C:\\SSLCert\\root-CA.pem\", \"Machine\") \n</code></pre></div></div>\n\n<h2 id=\"summary\">Summary</h2>\n\n<p>The update itself was easy, but it took us some hours to configure our Build Agents. After the initial hiccup it went smooth from there - no issues and we are ready for the next update, which is already <a href=\"https://docs.microsoft.com/en-us/azure/devops/server/release-notes/azuredevops2020?view=azure-devops\">released</a>.</p>\n\n<p>Hope this helps!</p>\n","Href":"https://blog.codeinside.eu/2020/11/30/update-onprem-azuredevops-server-2019-to-azuredevops-server-2019-update1/","RawContent":null,"Thumbnail":null},{"Title":"DllRegisterServer 0x80020009 Error","PublishedOn":"2020-10-31T23:45:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<p>Last week I had a very strange issue and the solution was really ‚Äúeasy‚Äù, but took me a while.</p>\n\n<h1 id=\"scenario\">Scenario</h1>\n\n<p>For our products we build Office COM Addins with a C++ based ‚ÄúShim‚Äù that boots up our .NET code (e.g. something <a href=\"https://github.com/NetOfficeFw/ShimmingExample\">like this</a>.\nAs the nature of COM: It requires some pretty dumb registry entries to work and in theory our toolchain should ‚Äúbuild‚Äù and automatically ‚Äúregister‚Äù the output.</p>\n\n<h1 id=\"problem\">Problem</h1>\n\n<p>The registration process just failed with a error message like that:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>The module xxx.dll was loaded but the call to DllRegisterServer failed with error code 0x80020009\n</code></pre></div></div>\n\n<p>After some research you will find some very old stuff or only some general advises like in this <a href=\"https://stackoverflow.com/questions/2727563/registering-a-dll-returns-0x80020009-error\">Stackoverflow.com question</a>, e.g. ‚Äúrun it as administrator‚Äù.</p>\n\n<h1 id=\"the-solution\">The solution</h1>\n\n<p>Luckily we had another project were we use the same approach and this worked without any issues. After comparing the files I notices some subtile differences: The <strong>file encoding</strong> was different!</p>\n\n<p>In my failing project some C++ files were encoded with <strong>UTF8-BOM</strong>. I changed everything to <strong>UTF8</strong> and after this change it worked.</p>\n\n<p>My reaction:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>(‚ïØ¬∞‚ñ°¬∞Ôºâ‚ïØÔ∏µ ‚îª‚îÅ‚îª\n</code></pre></div></div>\n\n<p>I‚Äôm not a C++ dev and I‚Äôm not even sure why some files had the wrong encoding in the first place. It ‚Äúworked‚Äù - at least Visual Studio 2019 was able to build the stuff, but register it with ‚Äúregsrv32‚Äù just failed.</p>\n\n<p>I needed some hours to figure that out.</p>\n\n<p>Hope this helps!</p>\n","Href":"https://blog.codeinside.eu/2020/10/31/dllregisterserver-0x80020009-error/","RawContent":null,"Thumbnail":null},{"Title":"How to share an Azure subscription in a team","PublishedOn":"2020-09-29T23:45:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"\n<p>We at <strong><a href=\"https://sevitec.ch/en/\">Sevitec</a></strong> are moving more and more workloads for us or our customers to Azure.</p>\n\n<p>So the basic question needs an answer:</p>\n\n<p>How can a team share an Azure subscription?</p>\n\n<p><em>Be aware: This approach works for us. There might be better options. If we do something stupid, just tell me in the comments or via email - help is appreciated.</em></p>\n\n<h1 id=\"step-1-create-a-directory\">Step 1: Create a directory</h1>\n\n<p>We have a ‚Äúcompany directory‚Äù with a fully configured Azure Active Directory (incl. User sync between our OnPrem system, Office 365 licenses etc.).</p>\n\n<p>Our rule of thumb is: We create for each product team a individual directory and all team members are invited in the new directory.</p>\n\n<p>Keep in mind: A directory itself costs you nothing but might help you to keep things manageable.</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2020-09-29/step1.png\" alt=\"Create a new tenant directory\" title=\"Create a new tenant directory\" /></p>\n\n<h1 id=\"step-2-create-a-group\">Step 2: Create a group</h1>\n\n<p>This step might be optional, but all team members - except the ‚ÄúAdministrator‚Äù - have the same rights and permissions in our company. To keep things simple, we created a group with all team members.</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2020-09-29/step2.png\" alt=\"Put all invited users in a group\" title=\"Put all invited users in a group\" /></p>\n\n<h1 id=\"step-3-create-a-subscription\">Step 3: Create a subscription</h1>\n\n<p>Now create a subscription. The typical ‚ÄúPay-as-you-go‚Äù offer will work. Be aware that the user who creates the subscription is initially setup as the <strong>Administrator</strong>.</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2020-09-29/step3.png\" alt=\"Create a subscription\" title=\"Create a subscription\" /></p>\n\n<h1 id=\"step-4-share-the-subscription\">Step 4: ‚ÄúShare‚Äù the subscription</h1>\n\n<p>This is the most important step:</p>\n\n<p>You need to grant the individual  users or the group (from step 2) the <strong>‚ÄúContributor‚Äù</strong> role for this subscription via the ‚ÄúAccess control (IAM)‚Äù.\nThe hard part is to understand how those ‚ÄúRole assignment‚Äù affect the subscription. I‚Äôm not even sure if the ‚ÄúContributor‚Äù is the best fit, but it works for us.</p>\n\n<p><img src=\"https://blog.codeinside.eu/assets/md-images/2020-09-29/step4.png\" alt=\"Pick the correct role assignment\" title=\"Pick the correct role assignment\" /></p>\n\n<h1 id=\"summary\">Summary</h1>\n\n<p>I‚Äôm not really sure why such a basic concept is labeled so poorly but you really need to pick the correct role assignment and the other person should be able to use the subscription.</p>\n\n<p>Hope this helps!</p>\n","Href":"https://blog.codeinside.eu/2020/09/29/how-to-share-an-azure-subscription-in-a-team/","RawContent":null,"Thumbnail":null}],"ResultType":"Feed"},"YouTube":{"FeedItems":[{"Title":"Erste Schritte mit dem Azure OpenAI Service","PublishedOn":"2023-03-23T22:30:48+00:00","CommentsCount":0,"FacebookCount":0,"Summary":null,"Href":"https://www.youtube.com/watch?v=VVNHT4gVxDo","RawContent":null,"Thumbnail":"https://i3.ytimg.com/vi/VVNHT4gVxDo/hqdefault.jpg"},{"Title":"Erster Schritt in die Source Control: Visual Studio Projekte auf GitHub pushen","PublishedOn":"2023-03-17T21:59:57+00:00","CommentsCount":0,"FacebookCount":0,"Summary":null,"Href":"https://www.youtube.com/watch?v=iKQS5nYbC-k","RawContent":null,"Thumbnail":"https://i2.ytimg.com/vi/iKQS5nYbC-k/hqdefault.jpg"},{"Title":"Vite.js f√ºr React & TypeScript f√ºr ASP.NET Core & Visual Studio Entwickler","PublishedOn":"2023-02-12T00:25:03+00:00","CommentsCount":0,"FacebookCount":0,"Summary":null,"Href":"https://www.youtube.com/watch?v=-2iiXpBcmDY","RawContent":null,"Thumbnail":"https://i2.ytimg.com/vi/-2iiXpBcmDY/hqdefault.jpg"},{"Title":"React.js mit TypeScript in ASP.NET Core mit Visual Studio & Visual Studio Code","PublishedOn":"2023-01-26T23:35:26+00:00","CommentsCount":0,"FacebookCount":0,"Summary":null,"Href":"https://www.youtube.com/watch?v=IgW79wxMO-c","RawContent":null,"Thumbnail":"https://i2.ytimg.com/vi/IgW79wxMO-c/hqdefault.jpg"},{"Title":"React.js mit ASP.NET Core - ein Einstieg mit Visual Studio","PublishedOn":"2022-10-07T23:15:55+00:00","CommentsCount":0,"FacebookCount":0,"Summary":null,"Href":"https://www.youtube.com/watch?v=gIzMtWDs_QM","RawContent":null,"Thumbnail":"https://i4.ytimg.com/vi/gIzMtWDs_QM/hqdefault.jpg"},{"Title":"Einstieg in die Webentwicklung mit .NET 6 & ASP.NET Core","PublishedOn":"2022-04-12T21:13:18+00:00","CommentsCount":0,"FacebookCount":0,"Summary":null,"Href":"https://www.youtube.com/watch?v=WtpzsW5Xwqo","RawContent":null,"Thumbnail":"https://i4.ytimg.com/vi/WtpzsW5Xwqo/hqdefault.jpg"},{"Title":"Das erste .NET 6 Programm","PublishedOn":"2022-01-30T22:21:35+00:00","CommentsCount":0,"FacebookCount":0,"Summary":null,"Href":"https://www.youtube.com/watch?v=fVzo2qJubmA","RawContent":null,"Thumbnail":"https://i3.ytimg.com/vi/fVzo2qJubmA/hqdefault.jpg"},{"Title":"Azure SQL - ist das echt so teuer? Neee...","PublishedOn":"2022-01-11T21:49:29+00:00","CommentsCount":0,"FacebookCount":0,"Summary":null,"Href":"https://www.youtube.com/watch?v=dNaIOGQj15M","RawContent":null,"Thumbnail":"https://i1.ytimg.com/vi/dNaIOGQj15M/hqdefault.jpg"},{"Title":"Was sind \"Project Templates\" in Visual Studio?","PublishedOn":"2021-12-22T22:36:25+00:00","CommentsCount":0,"FacebookCount":0,"Summary":null,"Href":"https://www.youtube.com/watch?v=_IMabo9yHSA","RawContent":null,"Thumbnail":"https://i4.ytimg.com/vi/_IMabo9yHSA/hqdefault.jpg"},{"Title":".NET Versionen - was bedeutet LTS und Current?","PublishedOn":"2021-12-21T21:06:29+00:00","CommentsCount":0,"FacebookCount":0,"Summary":null,"Href":"https://www.youtube.com/watch?v=2ghTKF0Ey_0","RawContent":null,"Thumbnail":"https://i3.ytimg.com/vi/2ghTKF0Ey_0/hqdefault.jpg"},{"Title":"Einstieg in die .NET Entwicklung f√ºr Anf√§nger","PublishedOn":"2021-12-20T22:18:35+00:00","CommentsCount":0,"FacebookCount":0,"Summary":null,"Href":"https://www.youtube.com/watch?v=2EcSJDX-8-s","RawContent":null,"Thumbnail":"https://i3.ytimg.com/vi/2EcSJDX-8-s/hqdefault.jpg"},{"Title":"Erste Schritte mit Unit Tests","PublishedOn":"2008-11-05T00:14:06+00:00","CommentsCount":0,"FacebookCount":0,"Summary":null,"Href":"https://www.youtube.com/watch?v=tjAv1-Qb4rY","RawContent":null,"Thumbnail":"https://i1.ytimg.com/vi/tjAv1-Qb4rY/hqdefault.jpg"},{"Title":"3 Schichten Architektur","PublishedOn":"2008-10-17T22:01:06+00:00","CommentsCount":0,"FacebookCount":0,"Summary":null,"Href":"https://www.youtube.com/watch?v=27yknlB8xeg","RawContent":null,"Thumbnail":"https://i3.ytimg.com/vi/27yknlB8xeg/hqdefault.jpg"}],"ResultType":"Feed"},"O_Blog":{"FeedItems":[{"Title":"How to build a simple hate speech detector with machine learning","PublishedOn":"2019-08-02T13:00:00+00:00","CommentsCount":0,"FacebookCount":0,"Summary":"<p>Not everybody on the internet behaves nice and some comments are just rude or offending. If you run a web page that offers a public comment function hate speech can be a real problem. For example in Germany, you are legally required to delete hate speech comments. This can be challenging if you have to check thousands of comments each day. \nSo wouldn‚Äôt it be nice, if you can automatically check the user‚Äôs comment and give them a little hint to stay nice?\n<!--description--></p>\n\n<p>The simplest thing you could do is to check if the user‚Äôs text contains offensive words. However, this approach is limited since you can offend people without using offensive words.</p>\n\n<p>This post will show you how to train a machine learning model that can detect if a comment or text is offensive. And to start you need just a few lines of Python code \\o/</p>\n\n<h2 id=\"the-data\">The Data</h2>\n\n<p>At first, you need data. In this case, you will need a list of offensive and nonoffensive texts. I wrote this tutorial for a machine learning course in Germany, so I used German texts but you should be able to use other languages too.</p>\n\n<p>For a machine learning competition, scientists provided a list of comments labeled as offensive and nonoffensive (<a href=\"https://projects.fzai.h-da.de/iggsa/projekt/\">Germeval 2018, Subtask 1</a>). This is perfect for us since we just can use this data.</p>\n\n<h2 id=\"the-code\">The Code</h2>\n\n<p>To tackle this task I would first establish a baseline and then improve this solution step by step. Luckily they also published the scores of all submission, so we can get a sense of how well we are doing.</p>\n\n<p>For our baseline model we are going to use <a href=\"https://fasttext.cc/\">Facebooks fastText</a>. It‚Äôs simple to use, works with many languages and does not require any special hardware like a GPU. Oh, and it‚Äôs fast :)</p>\n\n<h3 id=\"1-load-the-data\">1. Load the data</h3>\n\n<p>After you downloaded the training data file <a href=\"https://github.com/uds-lsv/GermEval-2018-Data\">germeval2018.training.txt</a> you need to transform this data into a format that fastText can read.\nFastTexts standard format looks like this ‚Äú<strong>label</strong>[your label] some text‚Äù:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>__label__offensive some insults\n__label__other have a nice day\n</code></pre></div></div>\n\n<h3 id=\"2-train-the-model\">2. Train the Model</h3>\n\n<p>To train the model you need to install the fastText Python package.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nv\">$ </span>pip <span class=\"nb\">install </span>fasttext\n</code></pre></div></div>\n<p>To train the model you need just there line of code.</p>\n<div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kn\">import</span> <span class=\"nn\">fasttext</span>\n<span class=\"n\">traning_parameters</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s\">'epoch'</span><span class=\"p\">:</span> <span class=\"mi\">50</span><span class=\"p\">,</span> <span class=\"s\">'lr'</span><span class=\"p\">:</span> <span class=\"mf\">0.05</span><span class=\"p\">,</span> <span class=\"s\">'loss'</span><span class=\"p\">:</span> <span class=\"s\">\"ns\"</span><span class=\"p\">,</span> <span class=\"s\">'thread'</span><span class=\"p\">:</span> <span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"s\">'ws'</span><span class=\"p\">:</span> <span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"s\">'dim'</span><span class=\"p\">:</span> <span class=\"mi\">100</span><span class=\"p\">}</span>    \n<span class=\"n\">model</span> <span class=\"o\">=</span> <span class=\"n\">fasttext</span><span class=\"p\">.</span><span class=\"n\">supervised</span><span class=\"p\">(</span><span class=\"s\">'fasttext.train'</span><span class=\"p\">,</span> <span class=\"s\">'model'</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">traning_parameters</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<p>I packed all the training parameters into a seperate dictionary. To me that looks a bit cleaner but you don‚Äôt need to do that.</p>\n\n<h3 id=\"3-test-your-model\">3. Test your Model</h3>\n\n<p>After we trained the model it is time to test how it performs. FastText provides us a handy test method the evaluate the model‚Äôs performance. To compare our model with the other models from the GermEval contest I also added a lambda which calculates the average <a href=\"https://en.wikipedia.org/wiki/F1_score\">F1 score</a>. For now, I did not use the official test script from the contests repository. Which you should do if you wanted to participate in such contests.</p>\n\n<div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">def</span> <span class=\"nf\">test</span><span class=\"p\">(</span><span class=\"n\">model</span><span class=\"p\">):</span>\n    <span class=\"n\">f1_score</span> <span class=\"o\">=</span> <span class=\"k\">lambda</span> <span class=\"n\">precision</span><span class=\"p\">,</span> <span class=\"n\">recall</span><span class=\"p\">:</span> <span class=\"mi\">2</span> <span class=\"o\">*</span> <span class=\"p\">((</span><span class=\"n\">precision</span> <span class=\"o\">*</span> <span class=\"n\">recall</span><span class=\"p\">)</span> <span class=\"o\">/</span> <span class=\"p\">(</span><span class=\"n\">precision</span> <span class=\"o\">+</span> <span class=\"n\">recall</span><span class=\"p\">))</span>\n    <span class=\"n\">nexamples</span><span class=\"p\">,</span> <span class=\"n\">recall</span><span class=\"p\">,</span> <span class=\"n\">precision</span> <span class=\"o\">=</span> <span class=\"n\">model</span><span class=\"p\">.</span><span class=\"n\">test</span><span class=\"p\">(</span><span class=\"s\">'fasttext.test'</span><span class=\"p\">)</span>\n    <span class=\"k\">print</span> <span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s\">'recall: </span><span class=\"si\">{</span><span class=\"n\">recall</span><span class=\"si\">}</span><span class=\"s\">'</span> <span class=\"p\">)</span>\n    <span class=\"k\">print</span> <span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s\">'precision: </span><span class=\"si\">{</span><span class=\"n\">precision</span><span class=\"si\">}</span><span class=\"s\">'</span><span class=\"p\">)</span>\n    <span class=\"k\">print</span> <span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s\">'f1 score: </span><span class=\"si\">{</span><span class=\"n\">f1_score</span><span class=\"p\">(</span><span class=\"n\">precision</span><span class=\"p\">,</span><span class=\"n\">recall</span><span class=\"p\">)</span><span class=\"si\">}</span><span class=\"s\">'</span><span class=\"p\">)</span>\n    <span class=\"k\">print</span> <span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s\">'number of examples: </span><span class=\"si\">{</span><span class=\"n\">nexamples</span><span class=\"si\">}</span><span class=\"s\">'</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<p>I don‚Äôt know about you, but I am so curious how we score. Annnnnnnd:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>recall: 0.7018686296715742\nprecision: 0.7018686296715742\nf1 score: 0.7018686296715742\nnumber of examples: 3532\n</code></pre></div></div>\n\n<p>Looking at the <a href=\"https://github.com/uds-lsv/GermEval-2018-Data/blob/master/results.pdf\">results</a> we can see that the best other model had an average F1 score of 76,77 and <strong>our model achieves -without any optimization and preprocessing- an F1 Score of 70.18.</strong></p>\n\n<p>This is pretty good since the models for these contests are usually specially optimized for the given data.</p>\n\n<p>FastText is a clever piece of software, that uses some neat tricks. If interested in fastText you should take a look the <a href=\"https://arxiv.org/abs/1607.04606\">paper</a> and <a href=\"https://arxiv.org/abs/1607.01759\">this one</a>. For example, fastText uses character n-grams. This approach is well suited for the German language, which uses a lot of compound words.</p>\n\n<h2 id=\"next-steps\">Next Steps</h2>\n\n<p>In this very basic tutorial, we trained a model with just a few lines of Python code. There are several things you can do to improve this model. The first step would be to preprocess your data. During preprocessing you could lower case all texts, remove URLs and special characters, correct spelling, etc. After every optimization step, you can test your model and check if your scores went up. Happy hacking :)</p>\n\n<p>Some Ideas:</p>\n\n<ol>\n  <li>Preprocess the data</li>\n  <li>Optimize the parameters (number of training epochs, learning rate, embedding dims, word n-grams)</li>\n  <li>Use pre-trained word vectors from the fastText website</li>\n  <li>add more data to the training set</li>\n  <li>Use data augmentation.</li>\n</ol>\n\n<p>Here is the full code:</p>\n\n<script src=\"https://gist.github.com/oliverguhr/31a1c93a1005d7e6e04c23d389d89cb7.js\"></script>\n\n<p>Credit: Photo by <a href=\"https://unsplash.com/photos/IYtVtgXw72M\">Jon Tyson on Unsplash</a></p>","Href":"https://www.oliverguhr.eu/nlp/jekyll/2019/08/02/build-a-simple-hate-speech-detector-with-machine-learning.html","RawContent":null,"Thumbnail":null}],"ResultType":"Feed"},"GitHubEventsUser":{"Events":[{"Id":"35236309092","Type":"IssuesEvent","CreatedAt":"2024-01-30T10:46:25","Actor":"robertmuehsig","Repository":"NetOfficeFw/NetOffice","Organization":"NetOfficeFw","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/NetOfficeFw/NetOffice/issues/402","RelatedDescription":"Opened issue \"NetOffice.OutlookApi.Application.GetActiveInstance() returns strange COM object if XmlSpy is running\" (#402) at NetOfficeFw/NetOffice","RelatedBody":"This is propably a strange bug, but one of our customers reported it and I can reproduce it as well.\r\n\r\nFirst:\r\n\r\n- Install XmlSpy (https://www.altova.com/xmlspy-xml-editor)\r\n- Run XmlSpy\r\n- Start Outlook\r\n- Run a sample application with code like this:\r\n\r\n```\r\nvar app = NetOffice.OutlookApi.Application.GetActiveInstance() ?? new NetOffice.OutlookApi.Application();\r\nvar mail = app.CreateItem(OlItemType.olMailItem) as MailItem;\r\n``` \r\n\r\n- Exception like this is produced:\r\n\r\n```\r\n--> [exception #1] NetOffice.Exceptions.MethodCOMException: Failed to proceed Method on Outlook.Application=>CreateItem.\r\n    --> [exception #2] System.Runtime.InteropServices.COMException: Unbekannter Name. (Ausnahme von HRESULT: 0x80020006 (DISP_E_UNKNOWNNAME))\r\n```\r\n\r\nIt seems that the \"GetActiveInstance\" returns something \"broken\" if XmlSpy is running:\r\n\r\n![image](https://github.com/NetOfficeFw/NetOffice/assets/756703/0dcb88fc-0622-46d4-b486-e390af8ab947)\r\n\r\nIf XmlSpy is not running the result is this:\r\n\r\n![image](https://github.com/NetOfficeFw/NetOffice/assets/756703/d555cde8-3da8-4049-82c9-959e4beafada)\r\n\r\nI have no idea why XmlSpy (a completely separat application) has such an effect on our application and on NetOffice.\r\n\r\nOur workaround now is, that we check if the `ActiveInstance` is broken or not and if yes, we return a new `Application` object.\r\n\r\nMy main question would be: Any idea why `GetActiveInstance` might return something strange?\r\n\r\nBest regards,\r\nRobert\r\n\r\n\r\n"},{"Id":"35055372356","Type":"IssuesEvent","CreatedAt":"2024-01-23T15:58:20","Actor":"robertmuehsig","Repository":"dotnet/winforms","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/winforms/issues/10723","RelatedDescription":"Opened issue \"ContextMenuStrip in Tray doesn't look \"Native\"\" (#10723) at dotnet/winforms","RelatedBody":"### .NET version\n\n6.0\n\n### Did it work in .NET Framework?\n\nYes\n\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\n\nNo\n\n### Issue description\n\nWe are in the process to migrate our application from \".NET Framework 4.8\" to .NET 6 (and upwards). \r\nThe \"Upgrade Assistant\" told us to migrate the \"ContextMenu\" (and similar classes) to the newer \"ContextMenuStrip\" system for our application tray icon.\r\n\r\nAfter we migrate the code the look and feel doesn't match the system.\r\n\r\nBefore:\r\n![image](https://github.com/dotnet/winforms/assets/756703/86001be3-de7c-4ac2-8aa9-6982805fe2bb)\r\n\r\nAfter:\r\n![image](https://github.com/dotnet/winforms/assets/756703/99acff01-65d1-40c7-9474-2862a795b14c)\r\n\r\nI already discovered these issues, but I wasn't sure if they apply to the \"tray icon\" stuff as well:\r\n- #2476\r\n- #2543\r\n\r\n... because drop downs in Windows 11 looks different then the items in a tray icon.\r\n\r\nMy question: Is this by design and an open bug or do I miss something? The goal would be that it should like other native tray menus.\r\n\r\n\r\n\n\n### Steps to reproduce\n\nFollowing code:\r\n\r\n```\r\nusing System;\r\nusing System.Drawing;\r\nusing System.Windows.Forms;\r\n\r\npublic class TrayApplicationContext : ApplicationContext\r\n{\r\n    private NotifyIcon trayIcon;\r\n    private ContextMenuStrip contextMenu;\r\n\r\n    public TrayApplicationContext()\r\n    {\r\n        InitializeContext();\r\n    }\r\n\r\n    private void InitializeContext()\r\n    {\r\n        // Create a context menu for the tray icon\r\n        contextMenu = new ContextMenuStrip();\r\n        contextMenu.Items.Add(\"Item 1\", null, OnItem1Click);\r\n        contextMenu.Items.Add(\"Item 2\", null, OnItem2Click);\r\n        contextMenu.Items.Add(new ToolStripSeparator());\r\n        contextMenu.Items.Add(\"Exit\", null, OnExitClick);\r\n\r\n        // Initialize the tray icon\r\n        trayIcon = new NotifyIcon()\r\n        {\r\n            Icon = SystemIcons.Application,\r\n            ContextMenuStrip = contextMenu,\r\n            Visible = true\r\n        };\r\n    }\r\n\r\n    private void OnItem1Click(object sender, EventArgs e)\r\n    {\r\n        MessageBox.Show(\"Item 1 clicked\");\r\n    }\r\n\r\n    private void OnItem2Click(object sender, EventArgs e)\r\n    {\r\n        MessageBox.Show(\"Item 2 clicked\");\r\n    }\r\n\r\n    private void OnExitClick(object sender, EventArgs e)\r\n    {\r\n        Application.Exit();\r\n    }\r\n}\r\n\r\npublic class Program\r\n{\r\n    [STAThread]\r\n    public static void Main()\r\n    {\r\n        Application.EnableVisualStyles();\r\n        Application.SetCompatibleTextRenderingDefault(false);\r\n        Application.Run(new TrayApplicationContext());\r\n    }\r\n}\r\n```\r\n\r\nWill render this:\r\n![image](https://github.com/dotnet/winforms/assets/756703/8d24b255-ed4e-4a05-b2bf-741f752de2a9)\r\n\r\nInstead of something like this:\r\n\r\n![image](https://github.com/dotnet/winforms/assets/756703/8017c648-f5d7-43e5-b9c1-148882561a3e)\r\n"},{"Id":"35012972997","Type":"IssuesEvent","CreatedAt":"2024-01-22T12:07:56","Actor":"oliverguhr","Repository":"oliverguhr/spelling","Organization":null,"RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/oliverguhr/spelling/issues/5","RelatedDescription":"Closed issue \"Spell Correction sequence issue with BART based Model\" (#5) at oliverguhr/spelling","RelatedBody":"Hey Oliver,\r\n\r\nI used this hugging face model oliverguhr/spelling-correction-english-base. i fine-tuned this on my own data(medical data). But i have observed that BART messes up with the input sequence.  For example.\r\nI need to consult a Geriatric Psychiatrists inside San Diego --> ['I need to consult a Geriatric Psychiatrists near by San Jose']\r\nI want an opinion from Chiropractic in 90048  --> ['I want an Audio from Cheropractic in 9 January']\r\n\r\nIs there any way where i can correct this type of issue and force model to give corrected sentence  in input sequence format? Any help would be highly appreciated.."},{"Id":"34926029849","Type":"IssuesEvent","CreatedAt":"2024-01-18T11:20:47","Actor":"robertmuehsig","Repository":"Azure/azure-sdk-for-net","Organization":"Azure","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/Azure/azure-sdk-for-net/issues/41390","RelatedDescription":"Opened issue \"[BUG] \"-windows\" TargetFramework requires \"Microsoft.WindowsDesktop.App\" and can't be deployed to Azure\" (#41390) at Azure/azure-sdk-for-net","RelatedBody":"### Library name and version\n\nAzure.Identity 1.10.4\n\n### Describe the bug\n\nWhen you create a \"Windows\" specific Web Application like that:\r\n\r\n```\r\n<Project Sdk=\"Microsoft.NET.Sdk.Web\">\r\n\r\n  <PropertyGroup>\r\n    <TargetFramework>net6.0-windows</TargetFramework>\r\n    <Nullable>enable</Nullable>\r\n    <ImplicitUsings>enable</ImplicitUsings>\r\n  </PropertyGroup>\r\n\r\n  <ItemGroup>\r\n    <PackageReference Include=\"Azure.Identity\" Version=\"1.10.4\" />\r\n  </ItemGroup>\r\n\r\n\r\n</Project>\r\n```\r\n\r\nThen the resulting project will require the WindowsDesktop runtime:\r\n\r\n```\r\n{\r\n  \"runtimeOptions\": {\r\n    \"tfm\": \"net6.0\",\r\n    \"frameworks\": [\r\n      {\r\n        \"name\": \"Microsoft.NETCore.App\",\r\n        \"version\": \"6.0.0\"\r\n      },\r\n      {\r\n        \"name\": \"Microsoft.WindowsDesktop.App\",\r\n        \"version\": \"6.0.0\"\r\n      },\r\n      {\r\n        \"name\": \"Microsoft.AspNetCore.App\",\r\n        \"version\": \"6.0.0\"\r\n      }\r\n    ],\r\n    \"configProperties\": {\r\n      \"System.GC.Server\": true,\r\n      \"System.Reflection.Metadata.MetadataUpdater.IsSupported\": false,\r\n      \"System.Runtime.Serialization.EnableUnsafeBinaryFormatterSerialization\": false\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nReason is the dependency `Microsoft.Identity.Client`, which will add WebView2 and other stuff to the dependency tree:\r\n![image](https://github.com/Azure/azure-sdk-for-net/assets/756703/53bec7c9-9588-4c3d-be2d-540df82ccf5e)\r\n\r\nThe problem:\r\na) It was quite suprising that the target runtime dependency has changed.\r\nb) This WindowsDesktop Runtime is not available on Azure (e.g. App Service).\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n\n### Expected behavior\n\nIt seems wrong that the TargetFramework \"net6.0-windows\" is treated like \"the application will be run on a desktop environment\". \r\nI always thought that \"net6.0-windows\" is for applications that uses Windows Specific APIs, which might be a Web Application. With the current behavior we had to use \"net6.0\" (which is in the end a good thing, but feels a bit drastic just because one NuGet package has a weird feature backed in).\n\n### Actual behavior\n\nThe desktop runtime is required.\n\n### Reproduction Steps\n\n- Create a MVC App and use \"net6.0-windows\" (or net8.0-windows) as TargetFramework\r\n- Add Azure.Identity\r\n- Deploy to azure\r\n\r\nResult:\r\n```\r\nYou must install or update .NET to run this application.\r\n\r\nApp: C:\\inetpub\\wwwroot\\primedocs\\Service\\PrimeDocs.Service.Host.dll\r\nArchitecture: x64\r\nFramework: 'Microsoft.WindowsDesktop.App', version '6.0.0' (x64)\r\n.NET location: C:\\Program Files\\dotnet\\\r\n\r\nNo frameworks were found.\r\n\r\nLearn about framework resolution:\r\nhttps://aka.ms/dotnet/app-launch-failed\r\n\r\n```\r\n\n\n### Environment\n\nAzure App Service"},{"Id":"34715561356","Type":"IssuesEvent","CreatedAt":"2024-01-10T13:57:00","Actor":"oliverguhr","Repository":"prateekralhan/Deep-Punctuation-Corrector","Organization":null,"RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/prateekralhan/Deep-Punctuation-Corrector/issues/2","RelatedDescription":"Opened issue \"Use python package for long texts\" (#2) at prateekralhan/Deep-Punctuation-Corrector","RelatedBody":"Hi @prateekralhan,\r\nthanks for building this! Currently, you are using the [Pipleine API](https://github.com/prateekralhan/Deep-Punctuation-Corrector/blob/f7225b637db36559e2d7ae4509bf1fa103ca8f53/app_funcs.py#L9). This works only for up to 512 tokens, so you run into issues when you process a longer document. I built an inference API that uses the same model and can process infinitely long text:\r\n\r\n```\r\nfrom deepmultilingualpunctuation import PunctuationModel\r\n\r\nmodel = PunctuationModel()\r\ntext = \"A very long text\r\nresult = model.restore_punctuation(text)\r\nprint(result)\r\n\r\n```\r\n\r\nBest,\r\nOliver\r\n"},{"Id":"34150624271","Type":"PullRequestEvent","CreatedAt":"2023-12-13T20:21:45","Actor":"oliverguhr","Repository":"teaching-ml/2022","Organization":"teaching-ml","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/teaching-ml/2022/pull/16","RelatedDescription":"Merged pull request \"paper urls\" (#16) at teaching-ml/2022","RelatedBody":"They are here, the papers have been published!!!\r\n\r\n@kmkinnaird or @oliverguhr or @abhicc feel free to press the button and merge this."}],"ResultType":"GitHubEvent"}},"RunOn":"2024-03-01T05:30:01.6247703Z","RunDurationInMilliseconds":960}